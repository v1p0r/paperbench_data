[
    {
        "type": "text",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "text_level": 1,
        "bbox": [
            205,
            109,
            767,
            131
        ],
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "Shuaicheng Niu 1 2 Chunyan Miao 1 2 3 Guohao Chen 4 Pengcheng $\\mathbf { W } \\mathbf { u } ^ { \\mathrm { ~ 1 ~ 2 ~ } }$ Peilin Zhao 4 ",
        "bbox": [
            174,
            176,
            790,
            193
        ],
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "Abstract ",
        "text_level": 1,
        "bbox": [
            243,
            219,
            318,
            236
        ],
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "Test-time adaptation has proven effective in adapting a given trained model to unseen test samples with potential distribution shifts. However, in real-world scenarios, models are usually deployed on resource-limited devices, e.g., FPGAs, and are often quantized and hard-coded with nonmodifiable parameters for acceleration. In light of this, existing methods are often infeasible since they heavily depend on computation-intensive backpropagation for model updating that may be not supported. To address this, we propose a testtime Forward-Optimization Adaptation (FOA) method. In FOA, we seek to solely learn a newly added prompt (as model’s input) via a derivativefree covariance matrix adaptation evolution strategy. To make this strategy work stably under our online unsupervised setting, we devise a novel fitness function by measuring test-training statistic discrepancy and model prediction entropy. Moreover, we design an activation shifting scheme that directly tunes the model activations for shifted test samples, making them align with the source training domain, thereby further enhancing adaptation performance. Without using any backpropagation and altering model weights, FOA runs on quantized 8-bit ViT outperforms gradient-based TENT on full-precision 32-bit ViT, while achieving an up to 24-fold memory reduction on ImageNet-C. Code: https://github.com/mr-eggplant/FOA. ",
        "bbox": [
            120,
            244,
            442,
            681
        ],
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "1. Introduction ",
        "text_level": 1,
        "bbox": [
            89,
            712,
            215,
            728
        ],
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "Deep neural networks often struggle to generalize when testing data encounter unseen corruptions or are drawn from novel environments (Hendrycks & Dietterich, 2019; Koh et al., 2021), known as distribution shifts. To address this, various methods have been extensively investigated in existing literature, such as domain generalization(Shankar et al., 2018; Dou et al., 2019), data augmentation (Hendrycks et al., 2020; Yao et al., 2022) and unsupervised domain adaptation (Saito et al., 2018; Zhang et al., 2020; Qiu et al., 2021). ",
        "bbox": [
            88,
            738,
            472,
            767
        ],
        "page_idx": 0
    },
    {
        "type": "table",
        "img_path": "images/d2c1c220783a7a1d205e834277bd798f792409f8920c6ffbcc04c0035280fb04.jpg",
        "table_caption": [
            "Table 1. Comparison w.r.t. prior gradient-based Test-Time Adaptation (TTA) vs. our Forward-Optimization Adaptation. The memory usage and accuracy are measured via ViT-Base and batch size 64 on ImageNet-C (level 5). The memory of 8-bit ViT is an ideal estimation by $0 . 2 5 \\times$ memory of 32-bit ViT per Liu et al. (2021b). "
        ],
        "table_footnote": [],
        "table_body": "<table><tr><td></td><td>Prior TTA</td><td>Forward-Optimization Adaptation</td></tr><tr><td>Update model weights</td><td>v X</td><td></td></tr><tr><td>Backward propagation</td><td>√</td><td>X</td></tr><tr><td>Model compatibility</td><td>Full precision models (32-bit)</td><td>Full precision models (32-bit) Quantized models: ·8-bit,6-bit,..</td></tr><tr><td>Device compatibility</td><td>High-performance GPU</td><td>High-performance GPU Low-power edge devices: ·smartphones, iPads,FPGAs ·embodied robots,..</td></tr><tr><td>Accuracy</td><td>59.6% (TENT, full precision,32-bit)</td><td>66.3% (full precision, 32-bit) 63.5% (quantized,8-bit)</td></tr><tr><td>Run-time memory usage</td><td>5,165 MB (TENT, full precision, 32-bit)</td><td>832 MB (full precision, 32-bit) 208 MB (quantized, 8-bit)</td></tr></table>",
        "bbox": [
            501,
            294,
            885,
            441
        ],
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            500,
            468,
            887,
            573
        ],
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "Recently, test-time adaptation (TTA) (Sun et al., 2020; Niu et al., 2023; Iwasawa & Matsuo, 2021; Bartler et al., 2022; Liang et al., 2023) has emerged as a rapidly progressing research area, with the aim of addressing domain shifts during test time. By utilizing each data point once for immediate adaptation post-inference, TTA stands out with its minimal overhead compared to prior areas, making it well-suited for real-world applications. According to whether involving backward propagation, existing TTA methods can generally be divided into the following two categories. ",
        "bbox": [
            500,
            582,
            885,
            731
        ],
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "Gradient-free methods learn from test data by adapting the statistics in batch normalization layers (Schneider et al., 2020; Khurana et al., 2021; Lim et al., 2023), correcting the output probabilities (Boudiaf et al., 2022), or adjusting the classifier (Iwasawa & Matsuo, 2021), etc. These methods, which avoid backpropagation and do not alter the original model weights, inherently reduce the risk of forgetting on source domain. However, their limited learning capacity, primarily stemming from the constraint of not explicitly exploiting the model feedback regarding given test samples to facilitate optimization with learnable parameters, may lead to suboptimal performance on out-of-distribution test data (as shown in Table 2). ",
        "bbox": [
            501,
            739,
            885,
            905
        ],
        "page_idx": 0
    },
    {
        "type": "discarded",
        "text": "1College of Computing and Data Science, Nanyang Technological University, Singapore 2Joint NTU-WeBank Research Centre on Fintech, Singapore 3 Joint NTU-UBC Research Centre of Excellence in Active Living for the Elderly (LILY), Singapore 4Tencent AI Lab, Shenzhen, China. Correspondence to: Shuaicheng Niu <shuaicheng.niu@ntu.edu.sg>. ",
        "bbox": [
            89,
            779,
            473,
            854
        ],
        "page_idx": 0
    },
    {
        "type": "discarded",
        "text": "",
        "bbox": [
            24,
            253,
            62,
            707
        ],
        "page_idx": 0
    },
    {
        "type": "discarded",
        "text": "Proceedings of the $\\mathit { 4 1 } ^ { s t }$ International Conference on Machine Learning, Vienna, Austria. PMLR 235, 2024. Copyright 2024 by the author(s). ",
        "bbox": [
            88,
            866,
            472,
            905
        ],
        "page_idx": 0
    },
    {
        "type": "discarded",
        "text": "1 ",
        "bbox": [
            482,
            922,
            490,
            934
        ],
        "page_idx": 0
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            88,
            85,
            472,
            114
        ],
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "Gradient-based methods (Sun et al., 2020; Wang et al., 2021; Goyal et al., 2022) unleash the power of TTA by online updating model parameters through self-/un-supervised learning during testing. These methods encompass a variety of techniques including, but not limited to, rotation prediction (Gidaris et al., 2018), contrastive learning (Bartler et al., 2022; Liu et al., 2021a), entropy minimization (Wang et al., 2021), etc. Although gradient-based TTA is effective in handling domain shifts, it still faces critical challenges when being deployed to real-world scenarios, as shown in Table 1. ",
        "bbox": [
            89,
            122,
            473,
            273
        ],
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "Firstly, deep models are usually deployed on various edge devices, e.g., smartphones, and embedded systems. Unlike high-performance GPUs, these devices typically possess limited computational power and memory capacity, insufficient for the intensive computations required by TTA, which often requires one or multiple rounds of backpropagation for each test sample (Wang et al., 2021; Zhang et al., 2022). ",
        "bbox": [
            89,
            281,
            473,
            386
        ],
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "Secondly, for resource or efficiency considerations, deep models often undergo quantization before deployment – a process of reducing precision, e.g., from 32-bit to 8-bit. However, the non-differentiability of the discrete quantizer would result in vanishing gradients when propagated through multiple layers (Louizos et al., 2019). This makes the deployed models incapable of supporting backpropagation operations, which are essential for prior TTA methods. ",
        "bbox": [
            89,
            395,
            473,
            515
        ],
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "Lastly, on some specialized computational chips that are tailored for specific models (Dass et al., 2023; You et al., 2023), the model parameters are often hard-coded and nonmodifiable. This rigidity of model parameters poses another barrier to the implementation of TTA. ",
        "bbox": [
            89,
            522,
            473,
            597
        ],
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "To address the above issues, we propose a test-time Forward-Optimization Adaptation (FOA) method. Specifically, we seek to explore a backpropagation-free optimizer, called covariance matrix adaptation (CMA) evolution strategy (Hansen, 2016), for online test-time model adaptation. However, naively applying CMA in the TTA setting is infeasible, as it is hard for CMA to handle ultra-high dimensional optimization problems (e.g., deep model training) and it relies on supervised learning signals. Therefore, we propose to solely update a newly inserted prompt (as the model’s input, shown in Figure 1) at test time to reduce the dimension of solution space and meanwhile avoid altering model weights. Then, to make CMA work stably without supervised signals, we devise a novel unsupervised fitness function to evaluate candidate solutions, which comprises both model prediction entropy and the activation statistics discrepancy between out-of-distribution (OOD) testing samples and source indistribution (ID) samples. Here, only a small number of ID samples is needed for source statistics estimation, i.e., 32 samples are sufficient for ImageNet (see Figure 2 (c)). Moreover, to further boost adaptation performance, we devise a forward-only back-to-source activation shifting mechanism to directly adjust the activations of OOD testing samples, along with a dynamically updated shifting direction from the OOD testing domain to the ID source domain. ",
        "bbox": [
            88,
            606,
            475,
            892
        ],
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            501,
            85,
            885,
            174
        ],
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "Main Contributions. 1) We introduce a novel and practical paradigm to TTA, termed forward-optimization adaptation. This paradigm operates without depending on backpropagation and avoids modification to the model weights, significantly broadening the real-world applicability of TTA across various contexts, including smartphones, FPGAs, and quantized models. 2) We achieve the goal of forward-only adaptation by prompt adaptation and activation shifting, where we design a new fitness function that guarantees stable prompt learning using a covariance matrix adaptation-based optimizer under the online unsupervised setting, and efficiently align the sample’s activations in the testing domain with the source training domain. 3) Extensive experiments on four benchmarks and full precision/quantized models verify our effectiveness. Our method on 8-bit quantized ViT outperforms gradient-based TENT on full-precision 32-bit ViT, with up to 24-fold run-time memory reduction. ",
        "bbox": [
            501,
            183,
            885,
            439
        ],
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "2. Preliminary and Problem Statement ",
        "text_level": 1,
        "bbox": [
            500,
            458,
            825,
            476
        ],
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "We briefly revisit ViT and TTA in this section for the convenience of our method presentation and put detailed related work discussions into Appendix A due to page limits. ",
        "bbox": [
            500,
            484,
            885,
            530
        ],
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "Vision Transformer (ViT) (Dosovitskiy et al., 2021). In this paper, we focus mainly on transformer-based vision models that are widely used in practice and are also hardware-friendly. We first revisit ViT here for the presentation convenience of our method. Formally, for a plain ViT $f _ { \\Theta } ( \\cdot )$ with $N$ layers, let $\\mathbf { E } _ { i } = \\{ \\mathbf { e } _ { i } ^ { j } , j \\in \\mathbb { N } , 0 \\leq j \\leq m \\}$ be the patch embeddings as the input of the $( i + 1 )$ -th layer $L _ { i + 1 }$ , where $m$ is the number of image patches and ${ \\bf e } _ { i } ^ { 0 }$ denote an extra learnable classification token ([CLS]) of the $i$ -th layer $L _ { i }$ , the whole ViT is formulated as: ",
        "bbox": [
            501,
            537,
            885,
            688
        ],
        "page_idx": 1
    },
    {
        "type": "equation",
        "img_path": "images/c78b0064b6d5c4080ae30d5766c9aaece5793887d42c6e0db3c71ddee4e66dce.jpg",
        "text": "$$\n\\begin{array} { r l } & { { \\bf E } _ { i } = L _ { i } ( { \\bf E } _ { i - 1 } ) , i = 1 , . . . , N } \\\\ & { \\quad \\hat { \\bf y } = \\mathrm { H e a d } ( { \\bf e } _ { N } ^ { 0 } ) . \\quad } \\end{array}\n$$",
        "text_format": "latex",
        "bbox": [
            589,
            698,
            795,
            739
        ],
        "page_idx": 1
    },
    {
        "type": "text",
        "text": "Test-Time Adaptation (TTA) (Sun et al., 2020; Wang et al., 2021). Let $f _ { \\Theta } ( \\cdot )$ be the model trained on labeled training dataset $\\mathcal { D } _ { t r a i n } = \\{ ( \\mathbf { x } _ { i } , y _ { i } ) \\} _ { i = 1 } ^ { N }$ and $\\mathbf { x } _ { i } \\sim P \\left( \\mathbf { x } \\right)$ . During testing, $f _ { \\Theta } ( \\cdot )$ shall perform well on in-distribution (ID) test samples drawn from $P \\left( \\mathbf { x } \\right)$ . However, given a set of outof-distribution (OOD) testing samples $\\mathcal { D } _ { t e s t } = \\{ \\mathbf { x } _ { j } \\} _ { j = 1 } ^ { M } \\sim$ $Q \\left( \\mathbf { x } \\right)$ and $Q \\left( \\mathbf { x } \\right) \\neq P \\left( \\mathbf { x } \\right)$ , the prediction performance of $f _ { \\Theta } ( \\cdot )$ would decrease significantly. To address this, TTA methods often seek to update the model parameters by minimizing some unsupervised/self-supervised learning objective when encountering a testing sample: ",
        "bbox": [
            501,
            755,
            885,
            905
        ],
        "page_idx": 1
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            310,
            58,
            661,
            70
        ],
        "page_idx": 1
    },
    {
        "type": "discarded",
        "text": "2 ",
        "bbox": [
            482,
            922,
            491,
            934
        ],
        "page_idx": 1
    },
    {
        "type": "image",
        "img_path": "images/a3e62b1b6a3054222b2e6ab443167ebdac82a822184f0902cd4e59dd2846d4bc.jpg",
        "image_caption": [
            "Figure 1. (a) An illustration of our proposed FOA. For each batch of online incoming test samples, we feed them alongside prompts $\\mathbf { p }$ into the TTA model, and calculate a fitness value that serves as a learning signal, aiding the covariance matrix adaptation (CMA) optimizer in learning the prompts p. This fitness function is derived from both the prediction entropy and the distribution discrepancy between the testing CLS activations and source CLS activations (calculated once). (b) We further boost the adaptation performance by directly adjusting the activations (before the final MLP head), guiding them from the testing distribution towards the source distribution. "
        ],
        "image_footnote": [],
        "bbox": [
            93,
            87,
            872,
            324
        ],
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            89,
            429,
            354,
            443
        ],
        "page_idx": 2
    },
    {
        "type": "equation",
        "img_path": "images/f10eec2f1f66fde051fee0660c5f6fc2f7f478911054f07de4eb295f9e50d971.jpg",
        "text": "$$\n\\operatorname* { m i n } _ { \\widetilde { \\Theta } } \\mathcal { L } ( \\mathbf { x } ; \\Theta ) , \\ : \\mathbf { x } \\sim Q \\left( \\mathbf { x } \\right) ,\n$$",
        "text_format": "latex",
        "bbox": [
            191,
            453,
            367,
            478
        ],
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "where ${ \\tilde { \\Theta } } \\subseteq \\Theta$ denotes the model parameters involved for updating. In general, the TTA objective $\\mathcal { L } ( \\cdot )$ can be formulated as rotation prediction (Sun et al., 2020), contrastive learning (Bartler et al., 2022), entropy minimization (Wang et al., 2021; Niu et al., 2023), etc. ",
        "bbox": [
            89,
            489,
            473,
            565
        ],
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "Problem Statement. In practical applications, deep models are frequently deployed on devices with limited resources, such as smartphones and embodied agents, and sometimes are even deployed after quantization or hard coding with non-modifiable parameters. These devices typically lack the capability for backward propagation, especially with largesize deep models. However, for existing TTA methods, such as SAR (Niu et al., 2023) and MEMO (Zhang et al., 2022), performing TTA necessitates one or more rounds of backward computation for each test sample. This process is highly memory- and computation-intensive, hindering the broad application of TTA methods in real-world scenarios. ",
        "bbox": [
            89,
            574,
            473,
            753
        ],
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "3. Approach ",
        "text_level": 1,
        "bbox": [
            88,
            773,
            192,
            791
        ],
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "In this paper, we propose a novel test-time ForwardOptimization Adaptation (FOA) method, which is also model updating-free, to boost the practicality of test-time adaptation in various real-world scenarios. From Figure 1, FOA conducts adaptation on both the input level and the output feature level. 1) Input level: FOA inserts a new prompt as the model’s input, and then solely updates this prompt online for out-of-distribution (OOD) generalization, employing a derivative-free optimizer coupled with a specially designed unsupervised fitness function (c.f. Section 3.1). 2) Output feature level: a back-to-source activation shifting strategy seeks to further boost adaptation, which directly refines the activation features of the final layer, by aligning them from the OOD domain back to the source indistribution (ID) domain (c.f. Section 3.2). We summarize the pseudo-code of FOA in Algorithm 1. ",
        "bbox": [
            89,
            800,
            473,
            905
        ],
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            500,
            429,
            885,
            564
        ],
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "3.1. Forward-Only Prompt Adaptation ",
        "text_level": 1,
        "bbox": [
            503,
            582,
            769,
            597
        ],
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "Unlike prior TTA methods that update model weights using backpropagation, we aim to achieve the goal of test-time out-of-distribution generalization in a backpropagation-free manner. To this end, we explore a derivative-free optimizer for TTA, namely covariance matrix adaptation (CMA) evolution strategy (Hansen, 2016). However, naively applying CMA to our TTA context is infeasible, the reasons are due to: 1) For TTA, the model parameters needing update are high-dimensional (even for methods like TENT (Wang et al., 2021) that only updates the affine parameters of normalization layers), since the deep models are often with millions of parameters. This makes CMA intractable for direct deep model adaptation. 2) Conventional CMA methods rely on supervised offline learning, i.e., using ground-truth labels to assess candidate solutions. In contrast, TTA operates without ground-truth labels and typically in an online setting, rendering conventional CMA methods inapplicable. We empirically illustrated these issues in Table 9. ",
        "bbox": [
            501,
            604,
            885,
            876
        ],
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "To make CMA work in TTA, we introduce a new prompt as ",
        "bbox": [
            500,
            883,
            885,
            898
        ],
        "page_idx": 2
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            312,
            58,
            661,
            69
        ],
        "page_idx": 2
    },
    {
        "type": "discarded",
        "text": "3 ",
        "bbox": [
            482,
            922,
            491,
            934
        ],
        "page_idx": 2
    },
    {
        "type": "text",
        "text": "Algorithm 1 Forward-Optimization Adaptation (FOA). ",
        "text_level": 1,
        "bbox": [
            88,
            84,
            455,
            99
        ],
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "Input: Batches of test samples $\\{ \\mathcal { X } _ { t } \\} _ { t = 1 } ^ { T }$ , model $f _ { \\Theta } ( \\cdot ) =$ P $\\begin{array} { r } { \\mathrm { H e a d } \\left( L _ { i } ( \\cdot ) \\right) } \\end{array}$ , ID statistics $\\{ \\mu _ { i } ^ { S } , \\pmb { \\sigma } _ { i } ^ { S } \\} _ { i = 0 } ^ { N }$ , pop. size $K$ .   \n1: Initialize $\\mathbf { m } ^ { ( 0 ) } = \\mathbf { 0 } , \\boldsymbol { \\Sigma } ^ { ( 0 ) } = \\mathbf { I } , \\boldsymbol { \\tau } ^ { ( 0 ) } = \\mathbf { 1 }$ in Eqn. (6).   \n2: for $t = 1 , 2 , . . . , T$ do   \n3: Sampling $K$ prompt solutions $\\{ \\mathbf { p } _ { k } ^ { t } \\} _ { k = 1 } ^ { K }$ by Eqn. (6).   \n4: for $k = 1 , . . . , K$ do   \n5: Calculate all layers’ CLS features $\\{ \\mathbf { e } _ { n } ^ { 0 } \\} _ { n = 1 } ^ { N }$ using Eqn. (1) with input $[ \\mathbf { p } _ { k } ^ { t } ; \\mathcal { X } _ { t } ]$ .   \n6: Adjust ${ \\bf e } _ { N } ^ { 0 }$ to source domain by Eqn. (7).   \n7: Predict $\\hat { \\mathcal { V } } _ { t } ^ { k }$ by $\\mathrm { H e a d } ( { \\mathbf { e } } _ { N } ^ { 0 } )$ .   \n8: Calculate fitness value $v _ { k }$ per Eqn. (5).   \n9: end for   \n10: Update $\\mathbf { m } ^ { ( t ) } , \\Sigma ^ { ( \\mathbf { t } ) } , \\tau ^ { ( \\mathbf { t } ) }$ according to $\\{ v _ { k } \\} _ { k = 1 } ^ { K }$ using the CMA-ES algorithm (Hansen, 2016).   \n11: Select final $\\hat { \\mathcal { V } } _ { t }$ from $\\{ \\hat { \\mathcal { V } } _ { t } ^ { k } \\} _ { k = 1 } ^ { K }$ with best $v _ { k }$ . ",
        "bbox": [
            91,
            103,
            473,
            332
        ],
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "Output: The predictions $\\{ \\hat { \\mathcal { V } } _ { t } \\} _ { t = 1 } ^ { T }$ the model’s input (as in Figure 1 (a)) for updating, thereby reducing the dimension of solution space and lowering the complexity for CMA optimization, meanwhile avoiding alter model weights. Then, we devise an unsupervised fitness function to provide consistent and reliable learning signals for the CMA optimization. We depict them in the following. ",
        "bbox": [
            89,
            347,
            318,
            362
        ],
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            88,
            391,
            473,
            481
        ],
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "CMA-Based Prompt Adaptation. Inspired by the demonstrated effectiveness of continuous prompt learning in the field of deep model fine-tuning (Jia et al., 2022; Bahng et al., 2022), we add new prompt embeddings at the beginning of the model input (i.e., before the first transformer layer) for test-time updating, while keeping all other model parameters frozen. In this way, the dimension of learnable model parameters shall be significantly reduced and thus is compatible with CMA optimization. Formally, given a test sample $\\mathbf { x } \\sim Q ( \\mathbf { x } )$ and a ViT model $f _ { \\Theta } ( \\cdot ) = \\operatorname { H e a d } ( L _ { i } ( \\cdot ) )$ , our goal is to find an optimal prompt $\\mathbf { p } ^ { * }$ : ",
        "bbox": [
            88,
            489,
            473,
            655
        ],
        "page_idx": 3
    },
    {
        "type": "equation",
        "img_path": "images/bd28faa17062a935bceea27c7f24c89c3b0635bd3d67abe80abefaf1e9bead7e.jpg",
        "text": "$$\n\\mathbf { p ^ { * } } = \\underset { \\mathbf { p } } { \\arg \\operatorname* { m i n } } \\mathcal { L } \\big ( f _ { \\Theta } ( \\mathbf { p } ; \\mathbf { x } ) \\big ) ,\n$$",
        "text_format": "latex",
        "bbox": [
            186,
            664,
            372,
            691
        ],
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "where $\\mathcal { L } ( \\cdot )$ is a fitness function and $\\mathbf { p } \\in \\mathbb { R } ^ { d \\times N _ { p } }$ consists of $N _ { p }$ prompt embeddings, each of dimension $d$ . We solve this problem by employing the derivative-free CMA. ",
        "bbox": [
            88,
            700,
            473,
            747
        ],
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "Fitness Function for CMA. To effectively solve Eqn. (4) using CMA, the primary challenge lies in developing an appropriate fitness $\\mathcal { L } ( \\cdot )$ to evaluate a given solution p. A direct approach might involve adopting existing TTA learning objectives, such as prediction entropy (Wang et al., 2021). However, this method encounters limitations when dealing with severely corrupted OOD samples, where model predictions are highly uncertain. In such cases, entropy-based measures struggle to provide consistent and reliable signals for CMA optimization. Moreover, focusing solely on optimizing entropy can lead the prompts towards degenerate and trivial solutions, as in Tables 5 and 9. To address these, we devise a new fitness to regularize the activation distribution statistics of OOD testing samples (forward propagated with optimized prompts), ensuring they are closely aligned with those from ID samples. This fitness functions at the distribution level, circumventing the issues of noise inherent in the uncertain predictions, thereby offering better stability. ",
        "bbox": [
            89,
            753,
            473,
            905
        ],
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            500,
            84,
            885,
            205
        ],
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "Statistics calculation. Before TTA, we first collect a small set of source in-distribution samples $\\mathcal { D } _ { S } = \\{ \\mathbf { x } _ { q } \\} _ { q = 1 } ^ { Q }$ and feed them into the model to obtain the corresponding CLS tokens $\\{ { \\bf e } _ { i } ^ { 0 } \\} _ { i = 1 } ^ { N }$ . Then, we calculate the mean and standard deviations of CLS tokens $\\{ { \\bf e } _ { i } ^ { 0 } \\} _ { i = 1 } ^ { N }$ over all samples in $\\mathcal { D } _ { S }$ to obtain source in-distribution statistics $\\{ \\mu _ { i } ^ { S } , \\pmb { \\sigma } _ { i } ^ { S } \\} _ { i = 0 } ^ { N }$ . Note that we only need a small number of in-distribution samples without labels for calculation, e.g., 32 samples are sufficient for the ImageNet dataset. Please refer to Figure 2 (c) for the sensitivity analyses regarding this calculate the target testing statistics $\\{ \\pmb { \\mu } _ { i } ( \\mathcal { X } _ { t } ) ) , \\pmb { \\sigma } _ { i } ( \\mathcal { X } _ { t } ) \\} _ { i = 0 } ^ { N }$ over the current batch of testing samples $\\mathcal { X } _ { t }$ . ",
        "bbox": [
            501,
            213,
            885,
            393
        ],
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "Based on the above, the overall fitness function for the $t$ -th test batch samples $\\mathcal { X } _ { t }$ is then given by: ",
        "bbox": [
            500,
            401,
            885,
            433
        ],
        "page_idx": 3
    },
    {
        "type": "equation",
        "img_path": "images/ec337996bf07b6e6ce833bb7f27cc7fb8fad9585f985cd703f5cc6b7e321e7ec.jpg",
        "text": "$$\n\\begin{array} { l } { \\displaystyle \\mathcal { L } ( f _ { \\Theta } ( \\mathbf { p } ; \\mathcal { X } _ { t } ) ) = \\sum _ { \\mathbf { x } \\in \\mathcal { X } _ { t } } \\sum _ { c \\in \\mathcal { C } } - \\hat { y } _ { c } \\log \\hat { y } _ { c } } \\\\ { \\displaystyle + \\lambda \\sum _ { i = 1 } ^ { N } \\lVert \\pmb { \\mu } _ { i } ( \\mathcal { X } _ { t } ) - \\pmb { \\mu } _ { i } ^ { S } \\rVert _ { 2 } + \\lVert \\pmb { \\sigma } _ { i } ( \\mathcal { X } _ { t } ) - \\pmb { \\sigma } _ { i } ^ { S } \\rVert _ { 2 } , } \\end{array}\n$$",
        "text_format": "latex",
        "bbox": [
            509,
            439,
            856,
            520
        ],
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "where $\\hat { y } _ { c }$ is the $c$ -th element of $\\hat { \\mathbf { y } }$ in Eqn. (2) w.r.t. sample $\\mathbf { x }$ and $\\lambda$ is a trade-off parameter. ",
        "bbox": [
            500,
            526,
            885,
            556
        ],
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "CMA Evolution Strategy. Instead of directly optimizing the prompt $\\mathbf { p }$ (in Eqn. 4) itself, we learn a multivariate normal distribution of $\\mathbf { p }$ using a covariance matrix adaptation (CMA) evolution strategy (Hansen & Ostermeier, 2001; Hansen et al., 2003). Here, we adopt CMA as it is one of the most successful and widely used evolutionary algorithms for non-convex black-box optimization in high-dimensional continuous solution spaces. To be specific, in each iteration $t$ (the $t$ -th batch of test samples $\\mathcal { X } _ { t }$ ), CMA samples a set/population of new candidate solutions/prompts (also known as individuals in evolution algorithms) from a parameterized multivariate normal distribution: ",
        "bbox": [
            501,
            564,
            885,
            744
        ],
        "page_idx": 3
    },
    {
        "type": "equation",
        "img_path": "images/6bc570492e168f95fc440f776181bab1ace9820e53cd56fa89ed0139f9cdd8c6.jpg",
        "text": "$$\n\\mathbf { p } _ { k } ^ { ( t ) } \\sim \\mathbf { m } ^ { ( t ) } + \\tau ^ { ( t ) } \\mathcal { N } ( \\mathbf { 0 } , \\Sigma ^ { ( \\mathbf { t } ) } ) .\n$$",
        "text_format": "latex",
        "bbox": [
            588,
            751,
            797,
            772
        ],
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "Here, $k { = } 1 , { \\ldots } , K$ and $K$ is the population size. $\\mathbf { m } ^ { ( t ) } { \\in } \\mathbb { R } ^ { d N _ { p } }$ is the mean vector of the search distribution at iteration step t, $\\tau ^ { ( t ) } \\in \\mathbb { R } _ { + }$ is the overall standard deviation that controls the step size, and $\\pmb { \\Sigma } ^ { ( \\mathbf { t } ) }$ is the covariance matrix that determines the shape of distribution ellipsoid. Upon sampling the prompts $\\{ \\mathbf { p } _ { k } ^ { ( t ) } \\} _ { k = 1 } ^ { K }$ , we feed each $\\mathbf { p } _ { k } ^ { ( t ) }$ along with the test sample $\\mathcal { X } _ { t }$ into the model to yield a fitness value $v _ { k }$ associated with $\\mathbf { p } _ { k } ^ { ( t ) }$ . Then, we update distribution parameters $\\mathbf { m } ^ { ( t ) }$ , $\\tau ^ { ( t ) }$ and $\\pmb { \\Sigma } ^ { ( \\mathbf { t } ) }$ based on the ranking of $\\{ v _ { k } \\} _ { k = 1 } ^ { K }$ by maximizing the likelihood of previous candidate successful solutions (c.f. Hansen (2016) for more algorithm details). ",
        "bbox": [
            500,
            780,
            885,
            906
        ],
        "page_idx": 3
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            310,
            58,
            661,
            70
        ],
        "page_idx": 3
    },
    {
        "type": "discarded",
        "text": "4 ",
        "bbox": [
            480,
            924,
            490,
            934
        ],
        "page_idx": 3
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            88,
            83,
            473,
            128
        ],
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "3.2. Back-to-Source Activation Shifting ",
        "text_level": 1,
        "bbox": [
            89,
            146,
            362,
            161
        ],
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "In this section, we propose a “back-to-source activation shifting mechanism” to further boost the adaptation performance at the feature level, in cases of the above online prompt adaptation is inadequate. This shifting scheme directly alters the model’s activations during inference and is notable for not requiring backpropagation. Specifically, given a test sample $\\mathbf { x }$ , we move its corresponding $N$ -th layer’s CLS feature ${ \\bf e } _ { N } ^ { 0 }$ (as shown in Eqn. (2), this feature is the input of the final task head), shifting them along the direction from out-of-distribution domain towards in-distribution domain: ",
        "bbox": [
            89,
            170,
            473,
            320
        ],
        "page_idx": 4
    },
    {
        "type": "equation",
        "img_path": "images/2dd888f2d51bd09cc3cfd9714afd0e54c3b20706c43208f8e7730673510b3a61.jpg",
        "text": "$$\n\\mathbf { e } _ { N } ^ { 0 }  \\mathbf { e } _ { N } ^ { 0 } + \\gamma \\mathbf { d } ,\n$$",
        "text_format": "latex",
        "bbox": [
            222,
            330,
            338,
            349
        ],
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "where $\\mathbf { d }$ is a shifting direction and $\\gamma$ is a step size. We define $\\mathbf { d }$ as the vector extending from the center of outof-distribution testing features to the center of source indistribution features. In our online TTA setting, with the increase of testing samples, the center of testing features shall dynamically change. Thus, we update the shifting direction $\\mathbf { d }$ online by: ",
        "bbox": [
            88,
            359,
            473,
            465
        ],
        "page_idx": 4
    },
    {
        "type": "equation",
        "img_path": "images/aec1168542f493be38e28fbfe224bf64863f84124a9e4053bf3fdabea4cba704.jpg",
        "text": "$$\n\\mathbf { d } _ { t } = \\pmb { \\mu } _ { N } ^ { S } - \\pmb { \\mu } _ { N } ( t ) ,\n$$",
        "text_format": "latex",
        "bbox": [
            214,
            474,
            346,
            494
        ],
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "where $\\mu _ { N } ^ { S }$ is the mean of the $N$ -th final layer CLS feature ${ \\bf e } _ { N } ^ { 0 }$ and calculated over source in-distribution samples $\\mathcal { D } _ { S }$ (the same one used in Eqn. (5)). $\\mu _ { N } ( t )$ is the approximation of the overall test set statistics by exponential moving averages of statistics computed on sequentially arrived test samples. We define the mean estimate of the ${ \\bf e } _ { N } ^ { 0 }$ in iteration $t$ (the $t$ -th batch $\\mathcal { X } _ { t }$ ) as: ",
        "bbox": [
            88,
            503,
            473,
            609
        ],
        "page_idx": 4
    },
    {
        "type": "equation",
        "img_path": "images/866982555596bc5169a03936d1527718de7c70a6acd109f0f96e743fc7bf2538.jpg",
        "text": "$$\n\\pmb { \\mu } _ { N } ( t ) = \\alpha \\pmb { \\mu } _ { N } ( \\pmb { \\chi } _ { t } ) + ( 1 - \\alpha ) \\pmb { \\mu } _ { N } ( t - 1 ) ,\n$$",
        "text_format": "latex",
        "bbox": [
            140,
            619,
            419,
            638
        ],
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "where $\\mu _ { N } ( \\lambda _ { t } )$ is the mean of the $N$ -th layer’s CLS feature and calculated over the $t$ -th test batch $\\mathcal { X } _ { t }$ . $\\alpha \\in [ 0 , 1 ]$ is a moving average factor and we set it to 0.1. ",
        "bbox": [
            88,
            648,
            473,
            694
        ],
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "4. Experiments ",
        "text_level": 1,
        "bbox": [
            89,
            713,
            215,
            729
        ],
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "Datasets and Models. We conduct experiments on four benchmarks for OOD generalization, i.e., ImageNetC (Hendrycks & Dietterich, 2019) (contains corrupted images in 15 types of 4 main categories and each type has 5 severity levels), ImageNet-R (various artistic renditions of 200 ImageNet classes) (Hendrycks et al., 2021), ImageNetV2 (Recht et al., 2019), ImageNet-Sketch (Wang et al., 2019). We use ViT-Base (Dosovitskiy et al., 2021) as the source model for all experiments, including both full precision and quantized ViT models. The models are trained on the source ImageNet-1K training set and the model weights are obtained from the timm repository (Wightman, 2019). We adopt PTQ4ViT (Yuan et al., 2022) for 8-bit and 6-bit model quantization. Unless stated otherwise, all ViT-Base models used in this paper are full precision with 32 bits. ",
        "bbox": [
            89,
            739,
            473,
            905
        ],
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            500,
            85,
            885,
            145
        ],
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "Compared Methods. We compare our proposed FOA with two categories of TTA methods. 1) Gradient-free methods: LAME (Boudiaf et al., 2022) is a post-training adaptation method by adjusting the model’s output probabilities; T3A (Iwasawa & Matsuo, 2021) updates a prototype-based classifier during test time. 2) Gradient-based methods: TENT (Wang et al., 2021) optimizes the affine parameters of norm layers by minimizing the prediction entropy of test samples and SAR (Niu et al., 2023) further optimizes the prediction entropy via active sample selection and a sharpness-aware optimizer; CoTTA (Wang et al., 2022) adapts a given model via augmentation-based consistency maximization and a teacher-student learning scheme. ",
        "bbox": [
            501,
            152,
            885,
            348
        ],
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "Implementation Details. We set the number of prompt embeddings $N _ { p }$ to 3 and initialize prompts with uniform initialization. We set the batch size $( B S )$ to 64 by following TENT and SAR for fair comparisons. The population size $K$ is set to $2 8 = 4 + 3 \\times \\log ($ (prompt dim) by following (Hansen, 2016) and $\\lambda$ in Eqn. (5) is set to $0 . 4 \\times B S / 6 4$ on ImageNet-C/V2/Sketch, and $0 . 2 { \\times } B S / 6 4$ on ImageNet-R to balance the magnitude of two losses. We use the validation set of ImageNet-1K to estimate source ID statistics. The step size $\\gamma$ in Eqn. (7) is set to 1.0, aiming to exactly align the overall center of testing and training features. The effect of each hyperparameter is investigated in Section 4.3 and Appendix C. More implementation details of compared methods are put in Appendix B.2. ",
        "bbox": [
            501,
            357,
            885,
            568
        ],
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "Evaluation Metrics. 1) Classification Accuracy $( \\% , \\uparrow )$ on OOD testing samples, i.e., ImageNet-C/R/V2/Sketch. 2) Expected Calibration Error (ECE) $( \\% , \\downarrow )$ measures the difference between predicted probabilities and actual outcomes in a probabilistic model (Naeini et al., 2015). ECE is important to evaluate the trustworthiness of model predictions, such as in medical diagnostics and auto driving. ",
        "bbox": [
            500,
            575,
            885,
            680
        ],
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "4.1. Results on Full Precision Models ",
        "text_level": 1,
        "bbox": [
            501,
            696,
            758,
            712
        ],
        "page_idx": 4
    },
    {
        "type": "text",
        "text": "In this section, we compare our FOA with existing state-ofthe-art TTA methods on the full precision ViT-Base model. From the results on ImageNet-C in Table 2, we have the following observations. 1) Our FOA achieves the best average accuracy and ECE over 15 different corruption types, suggesting our effectiveness. 2) Compared with NoAdapt, gradient-free methods LAME and T3A obtain slight performance gains or perform even worse, as they do not update core model weights and thus may suffer from limited learning capacity. Here, LAME performs worse than NoAdapt, because it only adjusts the model output logits and is not very effective when the OOD test sample stream does not suffer from prior label shifts, which is consistent with the results reported by LAME itself. 3) Compared with LAME and T3A, gradient-based methods (TENT, CoTTA and SAR) explicitly modify model parameters by optimizing unsupervised/self-supervised losses, and thus achieve much better performance, e.g., the average accuracy of $5 6 . 9 \\%$ (T3A) vs. $6 2 . 7 \\%$ (SAR). 4) Without using any backpropagation, our FOA outperforms gradient-based SAR with $3 . 6 \\%$ average accuracy and $3 . 8 \\%$ average ECE gains, demonstrating our superiority in deploying to lightweight devices (e.g., smartphones and FPGAs) and quantized models. 5) FOA achieves much lower average ECE compared with BP-based methods, e.g., $1 8 . 5 \\%$ (TENT) vs. $3 . 2 \\%$ (FOA). This mainly benefits from our activation discrepancy regularization (in Eqn. (5)), which alleviates the error accumulation issue of prior methods that may employ imprecise pseudo labels or entropy for learning. At last, from the results on ImageNet-R/V2/Sketch in Table 3, our FOA achieves the best or comparable performance w.r.t. both accuracy and ECE, further suggesting our effectiveness. ",
        "bbox": [
            501,
            722,
            885,
            901
        ],
        "page_idx": 4
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            312,
            58,
            661,
            70
        ],
        "page_idx": 4
    },
    {
        "type": "discarded",
        "text": "5 ",
        "bbox": [
            482,
            922,
            491,
            934
        ],
        "page_idx": 4
    },
    {
        "type": "table",
        "img_path": "images/af9b6d5ac2ab678a3f77bdbfd6a7897a3d49963e18738ab88fb084235bf29934.jpg",
        "table_caption": [
            "Table 2. Comparisons with SOTA methods on ImageNet-C (severity level 5) with ViT regarding Accuracy $( \\% )$ . BP is short for backward propagation and the bold number indicates the best result. We only report average ECE $( \\% , \\downarrow )$ here and put detailed ECEs in Appendix D. "
        ],
        "table_footnote": [],
        "table_body": "<table><tr><td></td><td colspan=\"4\">Noise</td><td colspan=\"4\">Blur</td><td colspan=\"4\">Weather</td><td colspan=\"4\">Digital</td><td colspan=\"2\">Average</td></tr><tr><td>Method</td><td>BP</td><td>Gauss.</td><td>Shot</td><td>Impul.</td><td>Defoc.</td><td>Glass Motion</td><td></td><td>Zoom</td><td>Snow</td><td>Frost</td><td>Fog</td><td>Brit.</td><td>Contr.</td><td>Elas.</td><td>Pix.</td><td>JPEG</td><td>Acc.</td><td>ECE</td></tr><tr><td>NoAdapt</td><td>X</td><td>56.8</td><td>56.8</td><td>57.5</td><td>46.9</td><td>35.6</td><td>53.1</td><td>44.8</td><td>62.2</td><td>62.5</td><td>65.7</td><td>77.7</td><td>32.6</td><td>46.0</td><td>67.0</td><td>67.6</td><td>55.5</td><td>10.5</td></tr><tr><td>LAME</td><td>X</td><td>56.5</td><td>56.5</td><td>57.2</td><td>46.4</td><td>34.7</td><td>52.7</td><td>44.2</td><td>58.4</td><td>61.5</td><td>63.1</td><td>77.4</td><td>24.7</td><td>44.6</td><td>66.6</td><td>67.2</td><td>54.1</td><td>11.0</td></tr><tr><td>T3A</td><td>X</td><td>56.4</td><td>56.9</td><td>57.3</td><td>47.9</td><td>37.8</td><td>54.3</td><td>46.9</td><td>63.6</td><td>60.8</td><td>68.5</td><td>78.1</td><td>38.3</td><td>50.0</td><td>67.6</td><td>69.1</td><td>56.9</td><td>26.8</td></tr><tr><td>TENT</td><td>v</td><td>60.3</td><td>61.6</td><td>61.8</td><td>59.2</td><td>56.5</td><td>63.5</td><td>59.2</td><td>54.3</td><td>64.5</td><td>2.3</td><td>79.1</td><td>67.4</td><td>61.5</td><td>72.5</td><td>70.6</td><td>59.6</td><td>18.5</td></tr><tr><td>CoTTA</td><td>v</td><td>63.6</td><td>63.8</td><td>64.1</td><td>55.5</td><td>51.1</td><td>63.6</td><td>55.5</td><td>70.0</td><td>69.4</td><td>71.578.5</td><td></td><td>9.7</td><td>64.5</td><td>73.4</td><td>71.2</td><td>61.7</td><td>6.5</td></tr><tr><td>SAR</td><td>v</td><td>59.2</td><td>60.5</td><td>60.7</td><td>57.5</td><td>55.6</td><td>61.8</td><td>57.6</td><td>65.9</td><td>63.5</td><td>69.1</td><td>78.7</td><td>45.7</td><td>62.4</td><td>71.9</td><td>70.3</td><td>62.7</td><td>7.0</td></tr><tr><td>FOA (ours)</td><td>X</td><td>61.5</td><td>63.2</td><td>63.3</td><td>59.3</td><td>56.7</td><td>61.4</td><td>57.7</td><td>69.4</td><td>69.6</td><td>73.4 81.1</td><td></td><td>67.7</td><td></td><td>62.773.9</td><td>73.0</td><td>66.3</td><td>3.2</td></tr></table>",
        "bbox": [
            91,
            126,
            883,
            247
        ],
        "page_idx": 5
    },
    {
        "type": "table",
        "img_path": "images/9eb0e961ef534db0bf5300804c8622a975ece0b9b994e190a799fbb81e8815eb.jpg",
        "table_caption": [
            "Table 3. Comparisons with state-of-the-art methods on ImageNetR/V2/Sketch with ViT-Base. BP is short for backward propagation and the bold number indicates the best result. "
        ],
        "table_footnote": [],
        "table_body": "<table><tr><td colspan=\"7\">Accuracy (%, ↑)</td><td colspan=\"3\">ECE(%,↓)</td></tr><tr><td>Method</td><td>BP|</td><td>R</td><td>V2</td><td>Sketch</td><td>Avg.</td><td>R</td><td>V2</td><td>Sketch</td><td>Avg.</td></tr><tr><td>NoAdapt</td><td></td><td>59.5</td><td>75.4</td><td>44.9</td><td>59.9</td><td>2.5</td><td>5.6</td><td>7.9</td><td>5.3</td></tr><tr><td>LAME</td><td></td><td>59.0</td><td>75.2</td><td>44.4</td><td>59.6</td><td>2.5</td><td>5.0</td><td>9.7</td><td>5.7</td></tr><tr><td>T3A</td><td></td><td>58.0</td><td>75.5</td><td>48.5</td><td>60.7</td><td>25.9</td><td>23.4</td><td>37.4</td><td>28.9</td></tr><tr><td>TENT</td><td></td><td>63.9</td><td>75.2</td><td>49.1</td><td>62.7</td><td>7.2</td><td>4.5</td><td>22.8</td><td>11.5</td></tr><tr><td>CoTTA</td><td></td><td>63.5</td><td>75.4</td><td>50.0</td><td>62.9</td><td>2.8</td><td>3.4</td><td>17.9</td><td>8.0</td></tr><tr><td>SAR</td><td></td><td>63.3</td><td>75.1</td><td>48.7</td><td>62.4</td><td>3.0</td><td>2.7</td><td>16.5</td><td>7.4</td></tr><tr><td>FOA (ours)</td><td>X</td><td>63.8</td><td>75.4</td><td>49.9</td><td>63.0</td><td>2.7</td><td>3.2</td><td>7.8</td><td>4.6</td></tr></table>",
        "bbox": [
            91,
            319,
            472,
            434
        ],
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            88,
            457,
            473,
            758
        ],
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "4.2. Results on Quantized Models ",
        "text_level": 1,
        "bbox": [
            89,
            776,
            321,
            791
        ],
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "In practical applications, deep models are often deployed on edge devices with efficiency considerations, undergoing a process known as quantization. These devices, constrained by limited resources, typically do not support backward propagation due to its high memory and computational demands. Consequently, traditional gradient-based TTA methods like TENT, CoTTA, and SAR are not viable in such settings. On the contrary, our FOA is adaptable to these quantized models. We demonstrate this by applying FOA to quantized ViT models and benchmarking it against T3A. As indicated in Table 4, FOA outperforms T3A significantly in terms of both accuracy and ECE on 8-bit and 6-bit models. Notably, FOA with an 8-bit ViT surpasses the performance of the gradient-based TENT method using a full precision 32-bit ViT on ImageNet-C, achieving $6 3 . 5 \\%$ accuracy (our FOA, 8-bit) vs. $5 9 . 6 \\%$ (TENT, 32-bit). These results collectively underscore the superiority of our FOA in such quantized model deployment scenarios. ",
        "bbox": [
            89,
            800,
            473,
            905
        ],
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            501,
            267,
            885,
            433
        ],
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "4.3. Ablation Studies ",
        "text_level": 1,
        "bbox": [
            500,
            449,
            647,
            463
        ],
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "Effectiveness of Components in FOA. In our FOA, we mentioned that naively applying CMA with entropy minimization in TTA is infeasible, and thus we propose an activation distribution discrepancy-based fitness function to guide the stable learning of CMA and an activation shifting scheme to boost the adaptation performance. We ablate them in Table 5. Firstly, CMA with Entropy fitness performs poorer than “NoAdapt”, which verifies the necessity of devising a new fitness function. Secondly, our Activation Discrepancy fitness works well to provide stable learning signals for CMA and improves the adaptation accuracy on ImageNet-C from $5 5 . 5 \\%$ to $6 3 . 4 \\%$ . Thirdly, even only with the Activation Shifting scheme, it also improves the accuracy from $5 5 . 5 \\%$ to $5 9 . 1 \\%$ , suggesting its effectiveness. Lastly, by incorporating Entropy and Activation Discrepancy as a whole fitness function and with the Activation Shifting scheme, our FOA achieves the best performance, i.e., $6 6 . 3 \\%$ average accuracy and $3 . 2 \\%$ average ECE on ImageNet-C. ",
        "bbox": [
            501,
            473,
            885,
            744
        ],
        "page_idx": 5
    },
    {
        "type": "text",
        "text": "Effects of Population Size $K$ in CMA (Eqn. (6)). We evaluate our FOA with different $K$ from $\\{ 2 , 3 , . . . , 2 8 \\}$ . From Figure 2 (a), the performance of our FOA converges when $K { > } 1 5$ . Notably, at $K { = } 2$ , FOA outperforms both NoAdapt and gradient-free T3A, e.g., $5 7 . 9 \\%$ (FOA) vs. $5 6 . 4 \\%$ (T3A) regarding accuracy. And with $K { = } 6$ , FOA surpasses the gradient-based TENT, i.e., $6 0 . 8 \\%$ accuracy (FOA) vs. $6 0 . 3 \\%$ (TENT). These results demonstrate the effectiveness of FOA under small $K$ values (the smaller $K$ , the higher efficiency). Please refer to Table 8 for efficiency comparisons. ",
        "bbox": [
            501,
            752,
            885,
            902
        ],
        "page_idx": 5
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            312,
            58,
            661,
            70
        ],
        "page_idx": 5
    },
    {
        "type": "discarded",
        "text": "6 ",
        "bbox": [
            480,
            924,
            491,
            934
        ],
        "page_idx": 5
    },
    {
        "type": "image",
        "img_path": "images/e3bc0489322acc427aad5e8dabd4ce92e345d946d66816181738c8ada9259a73.jpg",
        "image_caption": [
            "Figure 2. Parameter sensitivity analyses of our FOA. Experiments are conducted on ImageNet-C (Gaussian Noise, level 5) with ViT-Base. "
        ],
        "image_footnote": [],
        "bbox": [
            89,
            126,
            883,
            388
        ],
        "page_idx": 6
    },
    {
        "type": "table",
        "img_path": "images/47b1b0cdf4eb12fcabf81942e1eaed130c37cd2a92ba3644cf6f73052a6fcc4b.jpg",
        "table_caption": [
            "Table 4. Effectiveness of our FOA on Quantized ViT models. We report the corruption Accuracy $( \\% )$ and average ECE $( \\% , \\downarrow )$ on ImageNet-C (severity level 5). The bold number indicates the best result and see Appendix D for the detailed ECEs of each corruption. "
        ],
        "table_footnote": [],
        "table_body": "<table><tr><td></td><td>Entropy Act. Discrepancy Act. Shifting|</td><td></td><td>Acc.(%,↑)</td><td>ECE(%,↓)</td></tr><tr><td rowspan=\"5\">&lt;</td><td>NoAdapt</td><td></td><td>55.5</td><td>10.5</td></tr><tr><td></td><td></td><td>44.9</td><td>36.8</td></tr><tr><td>v</td><td></td><td>63.4</td><td>9.4</td></tr><tr><td></td><td>：</td><td>59.1</td><td>12.7</td></tr><tr><td>&lt;</td><td></td><td>63.8</td><td>9.9</td></tr><tr><td>&lt;</td><td>&lt;</td><td></td><td>65.4</td><td>3.3</td></tr><tr><td>&lt;</td><td>v</td><td>1</td><td>66.3</td><td>3.2</td></tr></table>",
        "bbox": [
            89,
            511,
            473,
            617
        ],
        "page_idx": 6
    },
    {
        "type": "text",
        "text": "Table 5. Ablations of components in our FOA. Entropy and Activation (Act.) Discrepancy are the left/right item in Fitness Function (Eqn. 5) used for CMA-based prompt adaptation. Act. Shifting is the method proposed in Section 3.2. We report the average results over 15 corruptions on ImageNet-C (level 5) with ViT-Base. ",
        "bbox": [
            88,
            435,
            473,
            505
        ],
        "page_idx": 6
    },
    {
        "type": "text",
        "text": "Effects of Number of Prompt Embeddings $N _ { p }$ in FOA. In our FOA, we add prompt embeddings in the input layer for CMA learning. Here, we evaluate FOA with different numbers of $N _ { p }$ , selected from $\\{ 1 , 2 , . . . , 1 0 \\}$ . In Figure 2 (b), we observe that the performance of FOA exhibits only minor variations across different $N _ { p }$ , showing a low sensitivity to $N _ { p }$ . Furthermore, setting $N _ { p }$ to $5 / 7$ results in marginally better performance, suggesting that this is a more optimal value. However, for all main experiments, we simply fix $N _ { p }$ at 3 and do not carefully tune $N _ { p }$ , as access to testing data for parameter tuning is typically unavailable in practice. ",
        "bbox": [
            89,
            641,
            473,
            808
        ],
        "page_idx": 6
    },
    {
        "type": "text",
        "text": "Effects of #Samples $( Q )$ for Calculating $\\{ \\mu _ { i } ^ { S } , \\pmb { \\sigma } _ { i } ^ { S } \\} _ { i = 0 } ^ { N }$ . As described in Section 3.1, the calculation of source training statistics $\\{ \\mu _ { i } ^ { S } , \\pmb { \\sigma } _ { i } ^ { S } \\} _ { i = 0 } ^ { N }$ involves a small set of unlabeled indistribution samples, which can be collected via existing OOD detection techniques (Berger et al., 2021) or directly using the training samples. Here, we investigate the effect of #samples needed, selected from $\\{ 1 6 , 3 2 , 6 4 , 1 0 0 , 2 0 0$ , 400, 800, $1 6 0 0 \\}$ . From Figure 2 (c), our FOA consistently achieves stable performance when #samples greater than 32, regarding both the accuracy and ECE. These results show that our FOA does not need to collect too many indistribution samples, which are easy to obtain in practice. ",
        "bbox": [
            89,
            814,
            473,
            905
        ],
        "page_idx": 6
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            500,
            428,
            885,
            517
        ],
        "page_idx": 6
    },
    {
        "type": "text",
        "text": "4.4. More Discussions ",
        "text_level": 1,
        "bbox": [
            501,
            535,
            651,
            549
        ],
        "page_idx": 6
    },
    {
        "type": "text",
        "text": "Results on Single Sample Adaptation (Batch $\\begin{array} { r } { \\operatorname { S i z e } = 1 } \\end{array}$ ). In our FOA, the prompt is learned over a batch of test samples each time. This process suffers from a challenge when the batch size is limited to one, as it requires the computation of the mean and variance of features, which may not be feasible with a single sample. Nonetheless, this issue is not significantly problematic in real-world applications. We propose a solution in the form of an interval update strategy, referred to as FOA-I. Specifically, given an ongoing stream of test data, we opt to update the prompts (performing CMA optimization) after encountering a pre-defined number of samples, denoted as $I$ . During this interval, we temporarily store the relevant features of all CLS tokens or the original image until the next update. From Table 6, our FOA-I is effective across various values of $I$ . Notably, FOA-I with an interval of $L { = } 4$ outperforms the accuracy of TENT (with batch size 64), suggesting its effectiveness. Interestingly, FOA-I with smaller intervals (e.g., $I { = } 4$ ) shows better performance than it with $I { = } 6 4$ . This is because a smaller $I$ leads to more CMA iteration steps for a given test data stream. ",
        "bbox": [
            500,
            558,
            885,
            859
        ],
        "page_idx": 6
    },
    {
        "type": "text",
        "text": "Run-Time Memory Usage. The memory usage during runtime is influenced by both the model and the batch size $( B S )$ . ",
        "bbox": [
            500,
            868,
            887,
            897
        ],
        "page_idx": 6
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            312,
            58,
            661,
            69
        ],
        "page_idx": 6
    },
    {
        "type": "discarded",
        "text": "7 ",
        "bbox": [
            482,
            922,
            490,
            934
        ],
        "page_idx": 6
    },
    {
        "type": "table",
        "img_path": "images/be87275f99ba18ecf6029f3352f03091406a067211dac501bfbf2dfd2095a5e8.jpg",
        "table_caption": [
            "Table 6. Effectiveness of FOA with interval update strategy (different intervals $I$ ), termed FOA-I, for single sample adaptation. We report results on ImageNet-C (Gaussian, level 5) with Vit-Base. "
        ],
        "table_footnote": [],
        "table_body": "<table><tr><td></td><td>NoAdapt</td><td>TENT (BS=64)</td><td>FOA-I (I=4)</td><td>FOA-I (I=8)</td><td>FOA-I (I=16)</td><td>FOA-I (I=32)</td><td>FOA-I (I=64)</td></tr><tr><td>Acc.</td><td>56.8</td><td>60.3</td><td>62.1</td><td>62.2</td><td>62.1</td><td>61.9</td><td>61.5</td></tr><tr><td>ECE</td><td>7.5</td><td>13.7</td><td>3.3</td><td>2.6</td><td>2.8</td><td>2.7</td><td>2.5</td></tr></table>",
        "bbox": [
            91,
            138,
            472,
            193
        ],
        "page_idx": 7
    },
    {
        "type": "table",
        "img_path": "images/6435fb456fbba9ab0284ccfdfd77167974ba9f48e4394f4359ae9c8e5b7bdb7c.jpg",
        "table_caption": [
            "Table 7. Comparison w.r.t. run-time memory (MB) usage. Results obtained via ViT-Base (32/8-bit) on ImageNet-C (Gaussian, level 5). FOA-I V1/V2 denote storing features/images for interval update under batch size $( B S )$ 1. The memory for 8-bit ViT is an ideal estimation by $0 . 2 5 \\times$ memory of 32-bit ViT per Liu et al. (2021b). "
        ],
        "table_footnote": [],
        "table_body": "<table><tr><td>BP</td><td>BS=1</td><td colspan=\"4\">BS=4 BS=8 BS=16 BS=32 BS=64</td></tr><tr><td>NoAdapt TENT</td><td>X 346</td><td>369 426 648</td><td>398 948</td><td>458 1,550</td><td>579 2,756</td><td>819 5,165</td></tr><tr><td>CoTTA</td><td></td><td>1,792 2,312</td><td>3,282</td><td>5,226</td><td>9,105</td><td>16,836</td></tr><tr><td>FOA FOA (8-bit)</td><td></td><td>372 1 1 93</td><td>402 100</td><td>464 116</td><td>587 147</td><td>832 208</td></tr><tr><td></td><td></td><td>BS=1,butupdate</td><td></td><td>prompt every Isamples</td><td></td><td></td></tr><tr><td></td><td></td><td>I=1 I=4</td><td>I=8</td><td>I=16</td><td>I=32</td><td>I=64</td></tr><tr><td>FOA-IV1</td><td>X</td><td>1 352</td><td>356</td><td>373</td><td>406</td><td>473</td></tr><tr><td>FOA-I V1 (8-bit)</td><td>X</td><td>88 1</td><td>89</td><td>93</td><td>102</td><td>118</td></tr><tr><td>FOA-IV2</td><td>×</td><td>351 1</td><td>353</td><td>358</td><td>368</td><td>388</td></tr><tr><td>FOA-IV2 (8-bit)</td><td>X</td><td>88 二</td><td>88</td><td>89</td><td>92</td><td>97</td></tr></table>",
        "bbox": [
            91,
            291,
            472,
            435
        ],
        "page_idx": 7
    },
    {
        "type": "text",
        "text": "We detail the memory consumption of different methods with different $B S$ in Table 7. Our FOA exhibits a marginally higher memory consumption compared to NoAdapt across different $B S$ , due to the need to maintain certain feature statistics, e.g., FOA requires 3MB extra memory than NoAdapt for $B S = 4$ . Notably, FOA significantly lowers memory usage compared to existing gradient-based TTA, e.g., 832 MB (FOA) vs. 5,165 MB (TENT) / 16,836 MB (CoTTA) under $B S = 6 4$ . Moreover, our FOA-I V1/V2, which are variants (introduced in the last subsection) designed for single sample adaptation ( $B S = 1$ ), with different update intervals $I$ further decrease the memory footprint of FOA. Lastly, applying FOA to quantized models yields additional memory savings proportional to the quantization level. These results verify the efficiency of FOA, particularly for deployment on resource-constrained edge devices. ",
        "bbox": [
            89,
            460,
            473,
            702
        ],
        "page_idx": 7
    },
    {
        "type": "text",
        "text": "Computational Complexity Analyses. The primary computational demand of FOA stems from $K$ (the population size in CMA) forward passes. Though FOA requires more forward passes than TENT, its independence from backward passes significantly reduces memory usage and potentially boosts overall efficiency. In Table 8, our Activation Shifting achieves almost the same efficiency as NoAdapt while outperforming T3A, i.e., $5 9 . 1 \\%$ vs. $5 6 . 9 \\%$ accuracy. Notably, our BP-free FOA $K { = } 2 ,$ ) matches the accuracy of BP-based TENT with lower run time and memory, and FOA $K { = } 6$ ) further surpasses BP-based CoTTA in all aspects. Moreover, even at $K { = } 2 8$ , FOA maintains much higher efficiency than augmentation-based methods like MEMO (Zhang et al., ",
        "bbox": [
            89,
            709,
            473,
            904
        ],
        "page_idx": 7
    },
    {
        "type": "text",
        "text": "Table 8. Comparisons w.r.t. computation complexity. FP/BP is short forward/backward propagation. #FP and #BP are numbers counted for processing a single sample. Accuracy $( \\% )$ and ECE $( \\% )$ are average results on ImageNet-C (level 5) with ViT-Base. The Wall-Clock Time (seconds) and Memory Usage (MB) are measured for processing 50,000 images of ImageNet-C on a single RTX 3090 GPU. $K$ is the population size in CMA and it works well with all $K \\in [ 2 , 2 8 ]$ and $K \\in \\mathbb { N } ^ { + }$ , as shown in Figure 2 (a). ",
        "bbox": [
            500,
            93,
            885,
            204
        ],
        "page_idx": 7
    },
    {
        "type": "table",
        "img_path": "images/c1474870ff98a8706821dfe4ea33206c06c9c4dd76283a124cf75293daadfea9.jpg",
        "table_caption": [],
        "table_footnote": [],
        "table_body": "<table><tr><td colspan=\"5\"></td><td rowspan=\"2\">Run Time (seconds)</td><td rowspan=\"2\">Memory (MB)</td></tr><tr><td>Method</td><td>|BP</td><td>#FP</td><td>#BP</td><td>Average Acc. ECE</td></tr><tr><td>NoAdapt T3A</td><td></td><td>1</td><td>0</td><td>55.5 10.5</td><td>119</td><td>819</td></tr><tr><td>MEMO</td><td></td><td>1 65</td><td>0 64</td><td>56.9 26.8 57.2 9.9</td><td>235 40.428</td><td>957 11,058</td></tr><tr><td>TENT</td><td></td><td>1</td><td>1</td><td>59.6 18.5</td><td>259</td><td>5,165</td></tr><tr><td>SAR</td><td>&lt;</td><td>[1,2]</td><td>[0,2]</td><td>62.7 7.0</td><td>517</td><td>5,166</td></tr><tr><td>CoTTA</td><td>&lt;</td><td>3or35</td><td>1</td><td>61.7 6.5</td><td>964</td><td>16,836</td></tr><tr><td>Act. Shifting</td><td>X</td><td>1</td><td>0</td><td></td><td>12.7</td><td></td></tr><tr><td>FOA (K=2)</td><td></td><td>2</td><td></td><td>59.1</td><td>120</td><td>821</td></tr><tr><td>FOA (K=4)</td><td></td><td></td><td>0</td><td>59.6 9.7</td><td>255</td><td>830</td></tr><tr><td></td><td></td><td>4</td><td>0</td><td>60.9 5.8</td><td>497</td><td>830</td></tr><tr><td>FOA (K=6)</td><td></td><td>6</td><td>0</td><td>62.7</td><td>4.6 740</td><td>830</td></tr><tr><td>FOA(K=28)</td><td></td><td>28</td><td>0</td><td>66.3</td><td>3.2</td><td>3.386 832</td></tr></table>",
        "bbox": [
            503,
            210,
            885,
            376
        ],
        "page_idx": 7
    },
    {
        "type": "table",
        "img_path": "images/3f4e36b2f9bc2d6a18597e792f36cc72574f07d70f7c9c09f6ebdf32839cf279.jpg",
        "table_caption": [
            "Table 9. Empirical studies of design choices w.r.t. learnable parameters, optimizer and loss function. We report the average results over 15 corruptions on ImageNet-C (level 5) with ViT-Base. "
        ],
        "table_footnote": [],
        "table_body": "<table><tr><td></td><td>Learnable Params</td><td>Optimizer</td><td>Loss</td><td>Acc. (↑)</td><td>ECE (↓)</td></tr><tr><td>NoAdapt</td><td>=</td><td>1</td><td>1 entropy</td><td rowspan=\"8\">55.5 64.6</td><td>10.5</td></tr><tr><td>TENT</td><td>norm layers</td><td>SGD</td><td>59.6 50.7</td><td>18.5 18.4</td></tr><tr><td>exp1</td><td>prompts</td><td>SGD SGD</td><td rowspan=\"8\">entropy Eqn. (5) 70.5 Eqn. (5)</td></tr><tr><td>exp2</td><td>norm layers</td></tr><tr><td>exp3</td><td>prompts</td></tr><tr><td>exp4</td><td>norm layers</td></tr><tr><td>exp5</td><td>CMA norm layers CMA</td></tr><tr><td></td><td>entropy 0.1 CMA entropy 44.9</td></tr><tr><td>exp6 Ours</td><td>prompts prompts CMA</td></tr></table>",
        "bbox": [
            503,
            453,
            885,
            579
        ],
        "page_idx": 7
    },
    {
        "type": "text",
        "text": "2022). In FOA, $K$ is a hyperparameter that one can select different values for performance and efficiency trade-off. Note that TENT updates only norm layers, making it more efficient than full-model backpropagation. ",
        "bbox": [
            500,
            611,
            885,
            671
        ],
        "page_idx": 7
    },
    {
        "type": "text",
        "text": "Effects of Design Choice w.r.t. Learnable Parameters, Optimizer and Loss. From Table 9, directly replacing SGD with CMA for entropy-based TTA is infeasible, e.g., the average accuracy degrades from $5 5 . 5 \\%$ to $0 . 1 \\%$ (norm layers, exp5) and $4 4 . 9 \\%$ (prompts, exp6). The reasons are that 1) CMA fails to handle ultra-high-dimensional optimization and 2) the entropy can not provide stable learning signals and thus tends to result in collapsed trivial solutions. However, with our devised fitness function (Eqn. (5)) and learnable prompts, CMA performs effectively, surpassing the gradient-based TENT. Moreover, our proposed loss function achieves excellent performance in the context of SGD learning, e.g., a comparison between exp2 and TENT shows that the average accuracy improves significantly from $5 9 . 6 \\%$ to $70 . 5 \\%$ , underscoring the effectiveness of Eqn. (5). ",
        "bbox": [
            501,
            679,
            885,
            905
        ],
        "page_idx": 7
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            310,
            58,
            661,
            70
        ],
        "page_idx": 7
    },
    {
        "type": "discarded",
        "text": "8 ",
        "bbox": [
            482,
            922,
            491,
            934
        ],
        "page_idx": 7
    },
    {
        "type": "table",
        "img_path": "images/44a4c0224a0b8269df942299e20025a3cf3e3d8fcf998cd78a35fc360f91aa13.jpg",
        "table_caption": [
            "Table 10. Effectiveness of FOA on ResNet and VisionMamba (Zhu et al., 2024). Results obtained on ImageNet-C (Gaussian noise, level 5). $\\mathrm { F O A } ^ { \\dag }$ is modified from FOA by replacing CMA optimizer with SGD and updating the affine parameters of norm layers. "
        ],
        "table_footnote": [],
        "table_body": "<table><tr><td colspan=\"4\">ResNet-50</td><td colspan=\"2\">VisionMamba</td></tr><tr><td>Method</td><td>Need BP?|Acc. (%)</td><td></td><td>ECE (%)</td><td>Acc. (%)</td><td>ECE(%)</td></tr><tr><td>NoAdapt</td><td>X</td><td>3.0</td><td>19.7</td><td>40.9</td><td>3.8</td></tr><tr><td>BN Adapt</td><td>X</td><td>16.0</td><td>1.3</td><td>n/a</td><td>n/a</td></tr><tr><td>TENT</td><td>1</td><td>29.4</td><td>11.4</td><td>49.2</td><td>12.1</td></tr><tr><td>SAR</td><td>&lt;</td><td>30.7</td><td>3.4</td><td>49.0</td><td>11.4</td></tr><tr><td>FOA (ours)</td><td>X</td><td>22.6</td><td>1.7</td><td>49.6</td><td>4.3</td></tr><tr><td>FOAt</td><td>1</td><td>33.6</td><td>12.8</td><td>56.5</td><td>13.6</td></tr></table>",
        "bbox": [
            91,
            152,
            472,
            260
        ],
        "page_idx": 8
    },
    {
        "type": "text",
        "text": "Effectiveness on ResNet (He et al., 2016) and VisionMamba (Zhu et al., 2024). For ResNet-50, we feed the original image to a learnable $7 \\times 7$ Conv layer to generate prompts with the same size as the image and then add prompts to the image as the model’s input. For VisionMamba, we concatenate learnable input prompts with the patch embeddings. We optimize these learnable parameters/prompts by FOA. From Table 10, FOA achieves comparable performance with gradient-based TENT and SAR on VisionMamba. While on ResNet-50, FOA outperforms BN Adapt (Schneider et al., 2020) but still suffers a large performance gap compared to TENT. This is because convolution is a local operation, making it hard to add location-invariant input prompts in CNN to affect the whole network, whereas in transformers this can be achieved using concatenation to add prompts. How to enhance the forward-only adaptation performance on ConvNets is still a promising and challenging direction, and we leave this to our future work. ",
        "bbox": [
            88,
            286,
            473,
            558
        ],
        "page_idx": 8
    },
    {
        "type": "text",
        "text": "Effectiveness under Non-i.i.d. Scenarios. We verify the effectiveness of FOA under two non-i.i.d. scenarios by following NOTE (Gong et al., 2022) and SAR (Niu et al., 2023), i.e., online imbalanced label distribution shifts: test data come in a class order and mixed domain shifts: test data stream consists of multiple randomly mixed domains with different distribution shifts. Results in Table 11 show that FOA performs stably even under non-i.i.d. settings. In general, the performance of all methods degrades when encountering non-i.i.d. scenarios. However, FOA still achieves the best performance compared with TENT and SAR, further demonstrating the superiority of the proposed back-tosource feature alignment fitness and feature shifting scheme. ",
        "bbox": [
            89,
            565,
            473,
            761
        ],
        "page_idx": 8
    },
    {
        "type": "text",
        "text": "Comparison w.r.t. In-Distribution Performance. From Table 12, our FOA maintains almost the same in-distribution accuracy as NoAdapt, outperforming all other compared methods. This success mainly benefits from: 1) we do not modify any internal model parameters, and 2) we regularize the target test features back to the source distribution via an alignment-based fitness function and an activation shifting scheme. Both of these two components are able to alleviate the issue of catastrophic forgetting. ",
        "bbox": [
            89,
            770,
            472,
            905
        ],
        "page_idx": 8
    },
    {
        "type": "text",
        "text": "Table 11. Effectiveness of FOA under non-i.i.d. scenarios. Results obtained on ViT and ImageNet-C (level 5). For mild (i.i.d.) and online imbalanced label shift scenarios, we report the average result over 15 corruptions. For mixed shifts, the performance is evaluated on a single data stream consisting of 15 mixed corruptions. ",
        "bbox": [
            500,
            93,
            885,
            162
        ],
        "page_idx": 8
    },
    {
        "type": "table",
        "img_path": "images/96f7d18c4ed3c35dfd5f31060fe1b04cf70ffb5f619d56db1a8bb2252df06cf8.jpg",
        "table_caption": [],
        "table_footnote": [],
        "table_body": "<table><tr><td colspan=\"4\"></td><td colspan=\"3\">mild scenarios online label shifts mixed shifts</td></tr><tr><td>Method</td><td>BP?</td><td>Acc.</td><td>ECE</td><td>Acc.</td><td>ECE</td><td>Acc. ECE</td></tr><tr><td>TENT</td><td>&lt;</td><td>59.6</td><td>18.5</td><td>60.2</td><td>17.7</td><td>56.9 29.2</td></tr><tr><td>SAR</td><td>v</td><td>62.7</td><td>7.0</td><td>60.8</td><td>61.4</td><td>14.8</td></tr><tr><td>FOA (ours)</td><td>X</td><td>66.3</td><td>3.2</td><td>62.1</td><td>7.5 6.6</td><td>62.0 4.9</td></tr></table>",
        "bbox": [
            503,
            169,
            882,
            236
        ],
        "page_idx": 8
    },
    {
        "type": "table",
        "img_path": "images/dee2d85581650e7ff3bc29edd8d69ab06c9ecda6ddb125642a4327e85a78f41b.jpg",
        "table_caption": [
            "Table 12. Comparison w.r.t. in-distribution performance, i.e., on clean/original ImageNet validation set, with ViT as the base model. "
        ],
        "table_footnote": [],
        "table_body": "<table><tr><td>Method</td><td>NoAdapt</td><td>TENT</td><td>CoTTA</td><td>SAR</td><td>FOA (ours)</td></tr><tr><td>Acc.(%)</td><td>85.17</td><td>84.80(-0.37)</td><td>83.91(−1.26)</td><td>84.52(-0.65)</td><td>85.11(−0.06)</td></tr><tr><td>ECE (%)</td><td>9.6</td><td>3.9</td><td>1.8</td><td>0.9</td><td>2.1</td></tr></table>",
        "bbox": [
            503,
            284,
            883,
            324
        ],
        "page_idx": 8
    },
    {
        "type": "text",
        "text": "Differences from Previous Forward-Only TTA. The main difference is that we explicitly exploit model feedback to facilitate optimization with learnable parameters, while prior forward-only TTA methods do not. For example, BN statistics calibration-based methods, including SITA (Khurana et al., 2021) exploit test data to calculate the mean and variances in batch norm layers, T3A (Iwasawa & Matsuo, 2021) adjusts class prototypes for adaptation, DDA (Gao et al., 2023) conducts diffusion on input images to remove the potential distribution shifts, etc. However, these methods do not actively learn from the model’s feedback w.r.t. a given test sample, and thus their performance on OOD data may be limited. In contrast, our FOA conducts explicit input prompt learning according to the model’s feedback, i.e., using the proposed fitness function consisting of prediction entropy and feature discrepancy, thereby achieving much better adaptation performance. ",
        "bbox": [
            501,
            347,
            885,
            603
        ],
        "page_idx": 8
    },
    {
        "type": "text",
        "text": "5. Conclusion ",
        "text_level": 1,
        "bbox": [
            500,
            622,
            614,
            638
        ],
        "page_idx": 8
    },
    {
        "type": "text",
        "text": "In this paper, we aim to implement online test-time adaptation without the need for backpropagation and altering the model parameters. This advancement highly broadens the scope of TTA’s real-world applications, particularly in resource-limited scenarios such as smartphones and FPGAs where backpropagation is often not feasible. To this end, we propose a test-time Forward-Optimization Adaptation (FOA) method. In FOA, we online learn an input prompt through a covariance matrix adaptation technique, paired with a designed unsupervised fitness function to provide stable learning signals. Moreover, we devise a “back-tosource” activation shifting scheme to directly alter the activations from the out-of-distribution domain to the source in-distribution domain, further boosting the adaptation performance. Extensive experiments on four large-scale outof-distribution benchmarks with full precision (32-bit) and quantized (8-bit/6-bit) models verify our superiority. ",
        "bbox": [
            501,
            650,
            885,
            905
        ],
        "page_idx": 8
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            312,
            58,
            661,
            70
        ],
        "page_idx": 8
    },
    {
        "type": "discarded",
        "text": "9 ",
        "bbox": [
            480,
            922,
            491,
            934
        ],
        "page_idx": 8
    },
    {
        "type": "text",
        "text": "Acknowledgment ",
        "text_level": 1,
        "bbox": [
            89,
            83,
            235,
            99
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "This research was supported, in part, by the Joint NTUWeBank Research Centre on Fintech, Nanyang Technological University, Singapore, and the National Research Foundation, Singapore under its Industry Alignment Fund – Pre-positioning (IAF-PP) Funding Initiative. Any opinions, findings and conclusions or recommendations expressed in this material are those of the authors and do not reflect the views of National Research Foundation, Singapore. The computational work was partially performed on resources of the National Supercomputing Centre, Singapore. ",
        "bbox": [
            89,
            109,
            473,
            260
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Impact Statement ",
        "text_level": 1,
        "bbox": [
            88,
            280,
            238,
            296
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "This paper presents work whose goal is to advance the field of test-time adaptation for out-of-distribution generalization. ",
        "bbox": [
            88,
            306,
            473,
            335
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "The societal impact of our work lies primarily in its potential to broaden the applicability of machine learning models in real-world scenarios, and facilitate their deployment on mobile computing, edge devices, and embedded systems, where power and processing capabilities are restricted. By making advanced machine learning more accessible to devices with lower specifications, our method can help democratize the benefits of AI technology. ",
        "bbox": [
            89,
            343,
            473,
            463
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Ethically, our work promotes more sustainable machine learning practices by reducing the computational overhead for model adaptation. This can contribute to lower energy consumption in machine learning deployments, aligning with environmental sustainability goals. Moreover, our method enables local model adaptation without the need to upload data to cloud servers, inherently enhancing data privacy and security. ",
        "bbox": [
            89,
            472,
            473,
            592
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "References ",
        "text_level": 1,
        "bbox": [
            89,
            612,
            181,
            628
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Abuduweili, A., Li, X., Shi, H., Xu, C.-Z., and Dou, D. Adaptive consistency regularization for semi-supervised transfer learning. In IEEE Conference on Computer Vision and Pattern Recognition, pp. 6923–6932, 2021. Bahng, H., Jahanian, A., Sankaranarayanan, S., and Isola, P. Exploring visual prompts for adapting large-scale models. arXiv preprint arXiv:2203.17274, 2022. Bartler, A., Buhler, A., Wiewel, F., D ¨ obler, M., and Yang, ¨ B. Mt3: Meta test-time training for self-supervised testtime adaption. In International Conference on Artificial Intelligence and Statistics, pp. 3080–3090. PMLR, 2022. Berger, C., Paschali, M., Glocker, B., and Kamnitsas, K. Confidence-based out-of-distribution detection: A comparative study and analysis. In Uncertainty for Safe Utilization of Machine Learning in Medical Imaging, and ",
        "bbox": [
            86,
            636,
            477,
            905
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Perinatal Imaging, Placental and Preterm Image Analysis, pp. 122–132. Springer, 2021. ",
        "bbox": [
            514,
            85,
            885,
            114
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Beyer, H.-G. and Sendhoff, B. Simplify your covariance matrix adaptation evolution strategy. IEEE Transactions on Evolutionary Computation, 21(5):746–759, 2017. ",
        "bbox": [
            500,
            126,
            885,
            170
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Boudiaf, M., Mueller, R., Ben Ayed, I., and Bertinetto, L. Parameter-free online test-time adaptation. In IEEE Conference on Computer Vision and Pattern Recognition, pp. 8344–8353, 2022. ",
        "bbox": [
            500,
            180,
            887,
            241
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Dass, J., Wu, S., Shi, H., Li, C., Ye, Z., Wang, Z., and Lin, Y. Vitality: Unifying low-rank and sparse approximation for vision transformer acceleration with a linear taylor attention. In IEEE International Symposium on HighPerformance Computer Architecture, pp. 415–428, 2023. ",
        "bbox": [
            500,
            251,
            885,
            325
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Deng, J., Dong, W., Socher, R., Li, L.-J., Li, K., and Fei-Fei, L. Imagenet: A large-scale hierarchical image database. In IEEE Conference on Computer Vision and Pattern Recognition, pp. 248–255, 2009. ",
        "bbox": [
            500,
            337,
            885,
            396
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Deng, Z., Chen, Z., Niu, S., Li, T., Zhuang, B., and Tan, M. Efficient test-time adaptation for super-resolution with second-order degradation and reconstruction. In Advances in Neural Information Processing Systems, 2024. ",
        "bbox": [
            500,
            406,
            885,
            468
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Dosovitskiy, A., Beyer, L., Kolesnikov, A., Weissenborn, D., Zhai, X., Unterthiner, T., Dehghani, M., Minderer, M., Heigold, G., Gelly, S., Uszkoreit, J., and Houlsby, N. An image is worth 16x16 words: Transformers for image recognition at scale. In International Conference on Learning Representations, 2021. ",
        "bbox": [
            500,
            477,
            887,
            568
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Dou, Q., Coelho de Castro, D., Kamnitsas, K., and Glocker, B. Domain generalization via model-agnostic learning of semantic features. In Advances in Neural Information Processing Systems, pp. 6447–6458, 2019. ",
        "bbox": [
            500,
            579,
            885,
            638
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Duchi, J. C., Jordan, M. I., Wainwright, M. J., and Wibisono, A. Optimal rates for zero-order convex optimization: The power of two function evaluations. IEEE Transactions on Information Theory, 61(5):2788–2806, 2015. ",
        "bbox": [
            500,
            648,
            885,
            708
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Eastwood, C., Mason, I., Williams, C., and Scholkopf, B. ¨ Source-free adaptation to measurement shift via bottomup feature restoration. In International Conference on Learning Representations, 2022. ",
        "bbox": [
            500,
            719,
            885,
            779
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Fleuret, F. et al. Test time adaptation through perturbation robustness. In Advances in Neural Information Processing Systems Workshop, 2021. ",
        "bbox": [
            500,
            790,
            885,
            835
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Gandelsman, Y., Sun, Y., Chen, X., and Efros, A. Testtime training with masked autoencoders. In Advances in Neural Information Processing Systems, volume 35, pp. 29374–29385, 2022. ",
        "bbox": [
            500,
            844,
            885,
            905
        ],
        "page_idx": 9
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            312,
            58,
            661,
            70
        ],
        "page_idx": 9
    },
    {
        "type": "discarded",
        "text": "",
        "bbox": [
            478,
            922,
            495,
            934
        ],
        "page_idx": 9
    },
    {
        "type": "text",
        "text": "Gao, J., Zhang, J., Liu, X., Shelhamer, E., Darrell, T., and Wang, D. Back to the source: Diffusion-driven test-time adaptation. In IEEE Conference on Computer Vision and Pattern Recognition, 2023. ",
        "bbox": [
            88,
            85,
            473,
            145
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Gidaris, S., Singh, P., and Komodakis, N. Unsupervised representation learning by predicting image rotations. In International Conference on Learning Representations, 2018. ",
        "bbox": [
            88,
            154,
            473,
            213
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Gong, T., Jeong, J., Kim, T., Kim, Y., Shin, J., and Lee, S.-J. Note: Robust continual test-time adaptation against temporal correlation. In Advances in Neural Information Processing Systems, volume 35, pp. 27253–27266, 2022. ",
        "bbox": [
            88,
            223,
            475,
            284
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Goyal, S., Sun, M., Raghunathan, A., and Kolter, J. Z. Test time adaptation via conjugate pseudo-labels. In Advances in Neural Information Processing Systems, volume 35, pp. 6204–6218, 2022. ",
        "bbox": [
            86,
            292,
            473,
            352
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Hansen, N. The cma evolution strategy: A tutorial. arXiv preprint arXiv:1604.00772, 2016. ",
        "bbox": [
            88,
            361,
            473,
            391
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Hansen, N. and Ostermeier, A. Completely derandomized self-adaptation in evolution strategies. Evolutionary Computation, 9(2):159–195, 2001. ",
        "bbox": [
            88,
            400,
            475,
            445
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Hansen, N., Muller, S. D., and Koumoutsakos, P. Reduc-¨ ing the time complexity of the derandomized evolution strategy with covariance matrix adaptation (cma-es). Evolutionary Computation, 11(1):1–18, 2003. ",
        "bbox": [
            86,
            454,
            475,
            513
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "He, K., Zhang, X., Ren, S., and Sun, J. Deep residual learning for image recognition. In IEEE Conference on Computer Vision and Pattern Recognition, pp. 770–778, 2016. ",
        "bbox": [
            86,
            523,
            475,
            583
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "He, X., Zheng, Z., and Zhou, Y. Mmes: Mixture modelbased evolution strategy for large-scale optimization. IEEE Transactions on Evolutionary Computation, 25(2): 320–333, 2020. ",
        "bbox": [
            86,
            593,
            475,
            651
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Hendrycks, D. and Dietterich, T. Benchmarking neural network robustness to common corruptions and perturbations. In International Conference on Learning Representations, 2019. ",
        "bbox": [
            86,
            661,
            475,
            722
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Hendrycks, D., Mu, N., Cubuk, E. D., Zoph, B., Gilmer, J., and Lakshminarayanan, B. Augmix: A simple data processing method to improve robustness and uncertainty. In International Conference on Learning Representations, 2020. ",
        "bbox": [
            88,
            731,
            475,
            805
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Hendrycks, D., Basart, S., Mu, N., Kadavath, S., Wang, F., Dorundo, E., Desai, R., Zhu, T., Parajuli, S., Guo, M., et al. The many faces of robustness: A critical analysis of out-of-distribution generalization. In IEEE Conference on Computer Vision and Pattern Recognition, pp. 8340– 8349, 2021. ",
        "bbox": [
            88,
            815,
            475,
            904
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Hong, J., Lyu, L., Zhou, J., and Spranger, M. MECTA: Memory-economic continual test-time model adaptation. In International Conference on Learning Representations, 2023. ",
        "bbox": [
            500,
            85,
            885,
            145
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Hu, X., Uzunbas, G., Chen, S., Wang, R., Shah, A., Nevatia, R., and Lim, S.-N. Mixnorm: Test-time adaptation through online normalization estimation. arXiv preprint arXiv:2110.11478, 2021. ",
        "bbox": [
            500,
            155,
            885,
            215
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Iwasawa, Y. and Matsuo, Y. Test-time classifier adjustment module for model-agnostic domain generalization. In Advances in Neural Information Processing Systems, volume 34, 2021. ",
        "bbox": [
            500,
            226,
            887,
            286
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Jamieson, K. G., Nowak, R., and Recht, B. Query complexity of derivative-free optimization. In Advances in Neural Information Processing Systems, volume 25, 2012. ",
        "bbox": [
            500,
            296,
            887,
            342
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Jia, M., Tang, L., Chen, B.-C., Cardie, C., Belongie, S., Hariharan, B., and Lim, S.-N. Visual prompt tuning. In European Conference on Computer Vision, pp. 709–727. Springer, 2022. ",
        "bbox": [
            500,
            352,
            887,
            411
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Khurana, A., Paul, S., Rai, P., Biswas, S., and Aggarwal, G. Sita: Single image test-time adaptation. arXiv preprint arXiv:2112.02355, 2021. ",
        "bbox": [
            500,
            422,
            885,
            467
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Koh, P. W., Sagawa, S., Marklund, H., Xie, S. M., Zhang, M., Balsubramani, A., Hu, W., Yasunaga, M., Phillips, R. L., Gao, I., et al. Wilds: A benchmark of in-thewild distribution shifts. In International Conference on Machine Learning, pp. 5637–5664, 2021. ",
        "bbox": [
            500,
            477,
            887,
            553
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Li, K., Hopkins, A. K., Bau, D., Viegas, F., Pfister, H., ´ and Wattenberg, M. Emergent world representations: Exploring a sequence model trained on a synthetic task. In International Conference on Learning Representations, 2023a. ",
        "bbox": [
            498,
            563,
            887,
            637
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Li, K., Patel, O., Viegas, F., Pfister, H., and Wattenberg, ´ M. Inference-time intervention: Eliciting truthful answers from a language model. In Advances in Neural Information Processing Systems, 2023b. ",
        "bbox": [
            500,
            648,
            885,
            709
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Liang, J., He, R., and Tan, T. A comprehensive survey on test-time adaptation under distribution shifts. arXiv preprint arXiv:2303.15361, 2023. ",
        "bbox": [
            498,
            719,
            885,
            765
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Lim, H., Kim, B., Choo, J., and Choi, S. TTN: A domainshift aware batch normalization in test-time adaptation. In International Conference on Learning Representations, 2023. ",
        "bbox": [
            498,
            775,
            885,
            834
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Lin, W., Mirza, M. J., Kozinski, M., Possegger, H., Kuehne, H., and Bischof, H. Video test-time adaptation for action recognition. In IEEE Conference on Computer Vision and Pattern Recognition, pp. 22952–22961, 2023. ",
        "bbox": [
            500,
            845,
            885,
            905
        ],
        "page_idx": 10
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            310,
            58,
            661,
            70
        ],
        "page_idx": 10
    },
    {
        "type": "discarded",
        "text": "",
        "bbox": [
            478,
            922,
            493,
            935
        ],
        "page_idx": 10
    },
    {
        "type": "text",
        "text": "Liu, Y., Kothari, P., van Delft, B., Bellot-Gurlet, B., Mordan, T., and Alahi, A. Ttt++: When does self-supervised test-time training fail or thrive? In Advances in Neural Information Processing Systems, volume 34, 2021a. ",
        "bbox": [
            86,
            85,
            473,
            145
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Liu, Z., Wang, Y., Han, K., Zhang, W., Ma, S., and Gao, W. Post-training quantization for vision transformer. In Advances in Neural Information Processing Systems, volume 34, pp. 28092–28103, 2021b. ",
        "bbox": [
            86,
            155,
            475,
            215
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Long, M., Cao, Y., Wang, J., and Jordan, M. Learning transferable features with deep adaptation networks. In International Conference on Machine Learning, pp. 97– 105. PMLR, 2015. ",
        "bbox": [
            86,
            226,
            475,
            286
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Long, M., Zhu, H., Wang, J., and Jordan, M. I. Unsupervised domain adaptation with residual transfer networks. In Advances in Neural Information Processing Systems, volume 29, 2016. ",
        "bbox": [
            86,
            296,
            475,
            356
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Loshchilov, I., Glasmachers, T., and Beyer, H.-G. Large scale black-box optimization by limited-memory matrix adaptation. IEEE Transactions on Evolutionary Computation, 23(2):353–358, 2018. ",
        "bbox": [
            86,
            367,
            473,
            426
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Louizos, C., Reisser, M., Blankevoort, T., Gavves, E., and Welling, M. Relaxed quantization for discretized neural networks. In International Conference on Learning Representations, 2019. ",
        "bbox": [
            86,
            438,
            475,
            497
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Malladi, S., Gao, T., Nichani, E., Damian, A., Lee, J. D., Chen, D., and Arora, S. Fine-tuning language models with just forward passes. In Advances in Neural Information Processing Systems, 2023. ",
        "bbox": [
            86,
            507,
            475,
            568
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Mirza, M. J., Soneira, P. J., Lin, W., Kozinski, M., Possegger, H., and Bischof, H. Actmad: Activation matching to align distributions for test-time-training. In IEEE Conference on Computer Vision and Pattern Recognition, pp. 24152– 24161, 2023. ",
        "bbox": [
            86,
            578,
            475,
            652
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Nado, Z., Padhy, S., Sculley, D., D’Amour, A., Lakshminarayanan, B., and Snoek, J. Evaluating prediction-time batch normalization for robustness under covariate shift. arXiv preprint arXiv:2006.10963, 2020. ",
        "bbox": [
            86,
            664,
            475,
            723
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Naeini, M. P., Cooper, G., and Hauskrecht, M. Obtaining well calibrated probabilities using bayesian binning. In AAAI Conference on Artificial Intelligence, volume 29, 2015. ",
        "bbox": [
            86,
            734,
            473,
            794
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Niu, S., Wu, J., Zhang, Y., Chen, Y., Zheng, S., Zhao, P., and Tan, M. Efficient test-time model adaptation without forgetting. In International Conference on Machine Learning, pp. 16888–16905, 2022. ",
        "bbox": [
            86,
            804,
            475,
            866
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Niu, S., Wu, J., Zhang, Y., Wen, Z., Chen, Y., Zhao, P., and Tan, M. Towards stable test-time adaptation in dynamic wild world. In International Conference on Learning Representations, 2023. ",
        "bbox": [
            88,
            876,
            473,
            905
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            514,
            85,
            885,
            114
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Oh, Y., Lee, J., Choi, J., Jung, D., Hwang, U., and Yoon, S. Efficient diffusion-driven corruption editor for test-time adaptation. arXiv preprint arXiv:2403.10911, 2024. ",
        "bbox": [
            500,
            125,
            885,
            170
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Qiu, Z., Zhang, Y., Lin, H., Niu, S., Liu, Y., Du, Q., and Tan, M. Source-free domain adaptation via avatar prototype generation and adaptation. In International Joint Conference on Artificial Intelligence, 2021. ",
        "bbox": [
            500,
            180,
            885,
            241
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Recht, B., Roelofs, R., Schmidt, L., and Shankar, V. Do imagenet classifiers generalize to imagenet? In International Conference on Machine Learning, pp. 5389–5400, 2019. ",
        "bbox": [
            500,
            251,
            885,
            310
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Saito, K., Watanabe, K., Ushiku, Y., and Harada, T. Maximum classifier discrepancy for unsupervised domain adaptation. In IEEE Conference on Computer Vision and Pattern Recognition, pp. 3723–3732, 2018. ",
        "bbox": [
            500,
            321,
            885,
            382
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Schneider, S., Rusak, E., Eck, L., Bringmann, O., Brendel, W., and Bethge, M. Improving robustness against common corruptions by covariate shift adaptation. In Advances in Neural Information Processing Systems, volume 33, pp. 11539–11551, 2020. ",
        "bbox": [
            500,
            392,
            887,
            468
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Shamir, O. An optimal algorithm for bandit and zero-order convex optimization with two-point feedback. The Journal of Machine Learning Research, 18(1):1703–1713, 2017. ",
        "bbox": [
            500,
            478,
            885,
            537
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Shankar, S., Piratla, V., Chakrabarti, S., Chaudhuri, S., Jyothi, P., and Sarawagi, S. Generalizing across domains via cross-gradient training. In International Conference on Learning Representations, 2018. ",
        "bbox": [
            500,
            547,
            885,
            608
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Shu, M., Nie, W., Huang, D.-A., Yu, Z., Goldstein, T., Anandkumar, A., and Xiao, C. Test-time prompt tuning for zero-shot generalization in vision-language models. In Advances in Neural Information Processing Systems, volume 35, pp. 14274–14289, 2022. ",
        "bbox": [
            500,
            618,
            887,
            694
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Subramani, N., Suresh, N., and Peters, M. E. Extracting latent steering vectors from pretrained language models. In Findings of the Association for Computational Linguistics, 2022. ",
        "bbox": [
            500,
            704,
            885,
            763
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Sun, T., Shao, Y., Qian, H., Huang, X., and Qiu, X. Blackbox tuning for language-model-as-a-service. In International Conference on Machine Learning, pp. 20841– 20855. PMLR, 2022. ",
        "bbox": [
            500,
            775,
            887,
            834
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Sun, Y., Wang, X., Liu, Z., Miller, J., Efros, A., and Hardt, M. Test-time training with self-supervision for generalization under distribution shifts. In International Conference on Machine Learning, pp. 9229–9248, 2020. ",
        "bbox": [
            500,
            845,
            885,
            905
        ],
        "page_idx": 11
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            310,
            58,
            661,
            70
        ],
        "page_idx": 11
    },
    {
        "type": "discarded",
        "text": "12 ",
        "bbox": [
            478,
            922,
            495,
            935
        ],
        "page_idx": 11
    },
    {
        "type": "text",
        "text": "Tan, M., Chen, G., Wu, J., Zhang, Y., Chen, Y., Zhao, P., and Niu, S. Uncertainty-calibrated test-time model adaptation without forgetting. arXiv preprint arXiv:2403.11491, 2024. ",
        "bbox": [
            88,
            85,
            473,
            143
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Turner, A., Thiergart, L., Udell, D., Leech, G., Mini, U., and MacDiarmid, M. Activation addition: Steering language models without optimization. arXiv preprint arXiv:2308.10248, 2023. ",
        "bbox": [
            88,
            155,
            473,
            215
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Wang, D., Shelhamer, E., Liu, S., Olshausen, B., and Darrell, T. Tent: Fully test-time adaptation by entropy minimization. In International Conference on Learning Representations, 2021. ",
        "bbox": [
            88,
            226,
            475,
            286
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Wang, H., Ge, S., Lipton, Z., and Xing, E. P. Learning robust global representations by penalizing local predictive power. In Advances in Neural Information Processing Systems, pp. 10506–10518, 2019. ",
        "bbox": [
            88,
            296,
            473,
            357
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Wang, Q., Fink, O., Van Gool, L., and Dai, D. Continual test-time domain adaptation. In IEEE Conference on Computer Vision and Pattern Recognition, 2022. ",
        "bbox": [
            88,
            366,
            473,
            411
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Wen, Z., Niu, S., Li, G., Wu, Q., Tan, M., and Wu, Q. Test-time model adaptation for visual question answering with debiased self-supervisions. IEEE Transactions on Multimedia, 2023. ",
        "bbox": [
            88,
            421,
            475,
            482
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Wightman, R. Pytorch image models. https://github. com/rwightman/pytorch-image-models, 2019. ",
        "bbox": [
            88,
            492,
            475,
            537
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Yao, H., Wang, Y., Li, S., Zhang, L., Liang, W., Zou, J., and Finn, C. Improving out-of-distribution robustness via selective augmentation. In International Conference on Machine Learning, 2022. ",
        "bbox": [
            88,
            547,
            475,
            608
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "You, H., Sun, Z., Shi, H., Yu, Z., Zhao, Y., Zhang, Y., Li, C., Li, B., and Lin, Y. Vitcod: Vision transformer acceleration via dedicated algorithm and accelerator co-design. In IEEE International Symposium on High-Performance Computer Architecture, pp. 273–286, 2023. ",
        "bbox": [
            88,
            618,
            475,
            694
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Yu, L., Chen, Q., Lin, J., and He, L. Black-box prompt tuning for vision-language model as a service. In International Joint Conference on Artificial Intelligence, pp. 1686–1694, 2023. ",
        "bbox": [
            88,
            704,
            475,
            763
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Yuan, Z., Xue, C., Chen, Y., Wu, Q., and Sun, G. Ptq4vit: Post-training quantization for vision transformers with twin uniform quantization. In European Conference on Computer Vision, pp. 191–207. Springer, 2022. ",
        "bbox": [
            86,
            775,
            475,
            835
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Zeng, R., Deng, Q., Xu, H., Niu, S., and Chen, J. Exploring motion cues for video test-time adaptation. In Proceedings of the 31st ACM International Conference on Multimedia, pp. 1840–1850, 2023. ",
        "bbox": [
            86,
            844,
            475,
            905
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Zhang, M. M., Levine, S., and Finn, C. Memo: Test time robustness via adaptation and augmentation. In Advances in Neural Information Processing Systems, 2022. ",
        "bbox": [
            500,
            85,
            885,
            130
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Zhang, Y., Wei, Y., Wu, Q., Zhao, P., Niu, S., Huang, J., and Tan, M. Collaborative unsupervised domain adaptation for medical image diagnosis. IEEE Transactions on Image Processing, 29:7834–7844, 2020. ",
        "bbox": [
            500,
            140,
            885,
            200
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Zhao, B., Chen, C., and Xia, S.-T. DELTA: Degradation-free fully test-time adaptation. In International Conference on Learning Representations, 2023. ",
        "bbox": [
            498,
            210,
            885,
            256
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Zhu, L., Liao, B., Zhang, Q., Wang, X., Liu, W., and Wang, X. Vision mamba: Efficient visual representation learning with bidirectional state space model. arXiv preprint arXiv:2401.09417, 2024. ",
        "bbox": [
            498,
            265,
            885,
            325
        ],
        "page_idx": 12
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            310,
            58,
            661,
            70
        ],
        "page_idx": 12
    },
    {
        "type": "discarded",
        "text": "",
        "bbox": [
            478,
            922,
            495,
            934
        ],
        "page_idx": 12
    },
    {
        "type": "text",
        "text": "Test-Time Model Adaptation with Only Forward Passes Supplementary Materials ",
        "text_level": 1,
        "bbox": [
            207,
            109,
            766,
            155
        ],
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "A. Related Work ",
        "text_level": 1,
        "bbox": [
            89,
            199,
            230,
            215
        ],
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "Test-Time Adaptation (TTA) is designed to enhance the performance of a model on unseen test data, which may exhibit distribution shifts, by directly learning from the test data itself. We categorize the related TTA works into the following two groups for discussion, differentiated by their dependence on backward propagation. ",
        "bbox": [
            89,
            227,
            472,
            315
        ],
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "• Backpropagation (BP)-Free TTA. In the early development of BP-free TTA, attention was primarily given to adjusting batch normalization (BN) layer statistics by computing mean and variance from testing data (Nado et al., 2020; Schneider et al., 2020; Gong et al., 2022). This method, however, assumes multiple test samples for each prediction. To address this, later studies proposed single-sample BN adaptation techniques, such as using data augmentation (Khurana et al., 2021), mix-up training and testing statistics (Hu et al., 2021; Lim et al., 2023). Moreover, NOTE (Gong et al., 2022) proposes instance-aware batch normalization and DELTA (Zhao et al., 2023) exploits testtime batch re-normalization to adapt a given model under non-i.i.d. testing scenarios. In addition to BN adaptation, other methodologies have been explored and shown to be effective, such as prototype-based classifier adjustment (Iwasawa & Matsuo, 2021), predicted logits correction (Boudiaf et al., 2022), diffusion-based input image adaptation (Gao et al., 2023; Oh et al., 2024). However, since BP-free TTA does not update the core model parameters, it might exhibit limited learning capabilities, often resulting in suboptimal performance when dealing with out-of-distribution testing data. Therefore, BP-based TTA emerged as an effective solution to significantly boost the out-of-distribution generalization performance. ",
        "bbox": [
            89,
            325,
            473,
            700
        ],
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "• Backpropagation-Based TTA. One pioneering work of BP-based TTA is known as Test-Time Training (TTT) (Sun et al., 2020). For TTT methods, they first train a source model using both supervised and self-supervised objectives, followed by adapting the model at test time with the selfsupervised objective, such as rotation prediction (Sun et al., 2020), contrastive learning (Liu et al., 2021a; Bartler et al., 2022), reconstruction learning (Gandelsman et al., 2022; Deng et al., 2024). To avoid directly altering the model training process and access to source data, Fully TTA methods update any given model via unsupervised learning objectives, such as entropy minimization (Wang et al., 2021; Wen et al., 2023; Niu et al., 2023; Tan et al., 2024), prediction consistency maximization (Zhang et al., 2022; Fleuret et al., 2021; Zeng et al., 2023) and feature distribution alignment (Mirza et al., 2023; Lin et al., 2023). ",
        "bbox": [
            89,
            709,
            473,
            904
        ],
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            500,
            202,
            885,
            246
        ],
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "However, BP-based TTA methods typically require multiple backward propagations for each test sample, leading to computational inefficiency. To tackle this, recent works (Niu et al., 2022; 2023; Wang et al., 2022; Shu et al., 2022) have proposed selecting confident or reliable samples for testtime model learning. This strategy significantly reduces the number of backward passes needed for an entire set of testing data, thereby enhancing adaptation efficiency and performance. Moreover, MECTA (Hong et al., 2023) proposes a series of techniques to reduce the run-time memory consumption of BP-based TTA, including reducing the batch size and stopping the BP caching heuristically. Nonetheless, these TTA methods still depend on BP, which poses challenges for resource-constrained edge devices like smartphones and FPGAs, especially those with quantized models. These devices often have limited memory and may not support backpropagation, thus hindering the broad realworld applications of BP-based TTA methods. In this context, we introduce a forward-only and optimization-based TTA method, aiming to achieve better performance than BP-based TTA methods but without using any backward propagation. ",
        "bbox": [
            501,
            253,
            885,
            585
        ],
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "Derivative-Free Learning (DFL) achieves optimization solely through evaluating the function values $f ( \\mathbf { x } )$ at sampled solutions $\\mathbf { x }$ , with minimal assumptions about the objective function (can be non-convex or black-box) and without the need for explicit derivatives. We review representative DFL methods below. ",
        "bbox": [
            501,
            594,
            885,
            684
        ],
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "• Evolutionary Algorithms. Covariance Matrix Adaptation Evolution Strategy (CMA-ES) (Hansen, 2016) is one of the most successful evolutionary approaches. It updates a covariance matrix of the multivariate normal distribution used to sample new solutions and effectively learns a secondorder model of the objective function, similar to approximating the inverse Hessian matrix in classical optimization. Based on CMA-ES, several recent works (Beyer & Sendhoff, 2017; He et al., 2020; Loshchilov et al., 2018) have been proposed to improve CMA-ES’s time and memory complexity. ",
        "bbox": [
            501,
            693,
            885,
            858
        ],
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "Nevertheless, CMA-ES still faces challenges in handling extremely high-dimensional optimization problems, such as deep model optimization. Recently, some efforts (Sun et al., 2022; Yu et al., 2023) have been made to adapt CMA algorithms for the scenario of Model-as-Service applications in language and vision-language models. However, these methods run on a pre-collected annotated dataset for a specific downstream task, and perform supervised optimization offline. In contrast, our approach adapts a given model to out-of-distribution testing data in an online and unsupervised manner. ",
        "bbox": [
            500,
            866,
            885,
            895
        ],
        "page_idx": 13
    },
    {
        "type": "discarded",
        "text": "",
        "bbox": [
            478,
            922,
            495,
            934
        ],
        "page_idx": 13
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            89,
            85,
            473,
            219
        ],
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "• Zeroth-Order Optimization methods estimate gradients by comparing the loss values of two forward passes (Duchi et al., 2015; Jamieson et al., 2012; Shamir, 2017), in which the model weights used in the second forward pass are altered from that used in the first forward pass through a random perturbation. One of the recent works (Malladi et al., 2023) introduced this optimization scheme in finetuning large language models and demonstrated its effectiveness. However, these methods still operate in an offline setting with few-shot supervised samples and are theorized to have slow convergence for optimizing large models (Malladi et al., 2023), which are not directly compatible with our online unsupervised TTA setting. Thus, in our FOA, we adopt the evolution-based CMA-ES method for prompt optimization. However, it is important to note that ZerothOrder optimization also presents a promising avenue for developing backpropagation-free TTA methods. Exploring this potential is an objective we aim to pursue in the future. ",
        "bbox": [
            89,
            228,
            473,
            500
        ],
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "Activation Editing methods directly modify the internal activation representations of a model to control the final output (Li et al., 2023a; Subramani et al., 2022), which has recently been explored in the field of language models. For example, Subramani et al. (2022) and Turner et al. (2023) exploit “steering vectors” for style transfer and Li et al. (2023b) adjust the attention heads to improve the truthfulness of large language models. In this work, inspired by this general idea, we propose a back-to-source activation shifting mechanism that online adjusts the model’s activations in real-time to enhance generalization to out-of-distribution testing data. ",
        "bbox": [
            89,
            507,
            473,
            688
        ],
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "Connection to Conventional Alignment-based Domain Adaptation Methods. Conventional DA methods often seek to learn domain-invariant features by minimizing the Maximum Mean Discrepancy (MMD) between the source and target distributions (Long et al., 2015; 2016; Abuduweili et al., 2021). BUFR (Eastwood et al., 2022) extends this idea to a source-free manner and directly minimizes the KL divergence between the source and target feature distributions. Our proposed Activation Shifting scheme follows the general idea of source-target alignment but differs from them mainly in two aspects. 1) Conventional DA methods often calculate the MMD or KL divergence as a differentiable loss function and exploit it for gradient backpropagation, thereby updating model weights. In contrast, our Activation Shifting directly edits the activations back to the source distribution in a gradient-free manner without modifying model weights, which facilitates efficient test-time adaptation. 2) Previous DA methods typically work offline, i.e., training the model on a pre-collected dataset for several epochs. Conversely, our Activation Shifting approach is effective for online test data streams, where adaptation occurs immediately after each mini-batch of test samples is processed (e.g., with batch sizes of 2 or 4). ",
        "bbox": [
            89,
            696,
            473,
            891
        ],
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            501,
            85,
            885,
            234
        ],
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "B. More Implementation Details ",
        "text_level": 1,
        "bbox": [
            501,
            255,
            769,
            272
        ],
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "B.1. More Details on Dataset ",
        "text_level": 1,
        "bbox": [
            501,
            281,
            700,
            295
        ],
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "In this paper, we conduct experiments on four ImageNet (Deng et al., 2009) variants to evaluate the out-of-distribution generalization ability, i.e., ImageNetC (Hendrycks & Dietterich, 2019), ImageNet-R (Hendrycks et al., 2021), ImageNet-V2 (Recht et al., 2019), and ImageNet-Sketch (Wang et al., 2019). ",
        "bbox": [
            501,
            305,
            885,
            395
        ],
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "ImageNet-C consists of various versions of corruption applied to 50,000 validation images from ImageNet. The dataset encompasses 15 distinct corruption types of 4 main groups, including Gaussian noise, shot noise, impulse noise, defocus blur, glass blur, motion blur, zoom blur, snow, frost, fog, brightness, contrast, elastic transformation, pixelation, and JPEG compression. Each corruption type is characterized by 5 different levels of severity, with higher severity levels indicating a more severe distribution shift. In our experiments, we specifically utilize severity level 5 for evaluation. ",
        "bbox": [
            501,
            404,
            885,
            568
        ],
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "ImageNet-R contains 30,000 images featuring diverse artistic renditions of 200 ImageNet classes. These images are predominantly sourced from Flickr and subjected to filtering by Amazon MTurk annotators. ",
        "bbox": [
            500,
            577,
            883,
            636
        ],
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "ImageNet-V2 is a newly collected test dataset extracted from the same test distribution as ImageNet. It comprises three test sets, each containing 10,000 new images and covering 1000 ImageNet classes. Following previous TTA methods (Nado et al., 2020), we utilize the Matched Frequency subset of ImageNet-V2 for evaluation, in which the images are sampled to match the class frequency distributions of the original ImageNet validation dataset. ",
        "bbox": [
            501,
            645,
            885,
            765
        ],
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "ImageNet-Sketch consists of 50,899 images represented as black and white sketches, encompassing 1000 ImageNet classes. Each class contains approximately 50 images. ",
        "bbox": [
            500,
            772,
            883,
            818
        ],
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "B.2. More Evaluation Protocols ",
        "text_level": 1,
        "bbox": [
            501,
            835,
            720,
            849
        ],
        "page_idx": 14
    },
    {
        "type": "text",
        "text": "We use ViT-Base (Dosovitskiy et al., 2021) as the source model backbone for all experiments. The model is trained on the source ImageNet-1K training set and the model weights1 are directly obtained from $\\pm \\mathrm { i } \\mathrm { m m } ^ { 2 }$ repository (Wightman, 2019). We adopt $\\mathrm { P T Q 4 V i T ^ { 3 } }$ (Yuan et al., 2022) for 8-bit and 6-bit model quantization with 32 randomly selected samples from the training set. We introduce the implementation details of all involved methods in the following. ",
        "bbox": [
            500,
            858,
            885,
            887
        ],
        "page_idx": 14
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            312,
            58,
            661,
            70
        ],
        "page_idx": 14
    },
    {
        "type": "discarded",
        "text": "",
        "bbox": [
            478,
            922,
            495,
            934
        ],
        "page_idx": 14
    },
    {
        "type": "image",
        "img_path": "images/9ec16bfdfa25a877071b0a1b26ea8f5fa2b9c2772958bd39bab1438eb49aa523.jpg",
        "image_caption": [
            "Figure 3. Visualizations of images in ImageNet and ImageNet-C/V2/R/Sketch, which are directly taken from their original papers. "
        ],
        "image_footnote": [],
        "bbox": [
            140,
            83,
            831,
            290
        ],
        "page_idx": 15
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            89,
            337,
            473,
            426
        ],
        "page_idx": 15
    },
    {
        "type": "text",
        "text": "FOA (Ours). For the default configuration of hyperparameters, the number of prompt embeddings $N _ { p }$ is set to 3 using uniform initialization. We use CMA- $\\mathrm { . E S }$ as the update rule, with the batch size $B S$ of 64, and the population size $K$ of $2 8 = 4 + 3 \\times \\log ( p r o m p t ~ d i m )$ by following (Hansen, 2016). The $\\lambda$ in Eqn. (5) is set to $0 . 4 \\times B S / 6 4$ on ImageNetC/V2/Sketch, and $0 . 2 { \\times } B S / 6 4$ on ImageNet-R to balance the magnitude of two losses. We use the validation set of ImageNet-1K to estimate source training statistics. The moving average factor $\\alpha$ in Eqn. (9) is set to 0.1. The step size $\\gamma$ in Eqn. (7) is set to 1.0, aiming to exactly align the overall center of testing and training features. For updating prompts and normalization layers with SGD optimizer in Table 9 with Eqn. (5), the entropy loss is divided by the batch size of 64 and the $\\lambda$ is set to 30 to make the two losses have similar magnitude. We investigate the effects of these hyperparameters with different setups in Sectipendix C. The source in-distribution statistics $\\{ \\mu _ { i } ^ { S } , \\pmb { \\sigma } _ { i } ^ { S } \\} _ { i = 0 } ^ { N }$ are calculated without using the newly inserted prompt. ",
        "bbox": [
            88,
            434,
            473,
            722
        ],
        "page_idx": 15
    },
    {
        "type": "text",
        "text": "$\\mathbf { L A M E } ^ { 5 }$ (Boudiaf et al., 2022). For fair comparison, we maintain a consistent batch size of 64 for LAME, aligning it with the same batch size used by other methods in our evaluation. We use the kNN affinity matrix with the value of k chosen from $\\{ 1 , 5 , 1 0 , 2 0 \\}$ , and for all experiments, we consistently set it to 5 based on the optimal accuracy observed on ImageNet-C. ",
        "bbox": [
            88,
            728,
            473,
            789
        ],
        "page_idx": 15
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            500,
            337,
            885,
            381
        ],
        "page_idx": 15
    },
    {
        "type": "text",
        "text": "$\\mathbf { T } \\mathbf { 3 } \\mathbf { A } ^ { 6 }$ (Iwasawa & Matsuo, 2021). We follow all hyperparameters that are set in T3A unless it does not provide. Specifically, the batch size is set to 64. The number of supports to restore $M$ is chosen from $\\{ 1 , 5 , 2 0 , 5 0 , 1 0 0 \\}$ and for all experiments, we consistently set it to 20 based on the optimal accuracy observed on ImageNet-C. ",
        "bbox": [
            500,
            388,
            885,
            479
        ],
        "page_idx": 15
    },
    {
        "type": "text",
        "text": "$\\mathbf { T E N T }$ (Wang et al., 2021). We follow all hyperparameters that are set in Tent unless it does not provide. Specifically, we use SGD as the update rule, with a momentum of 0.9, batch size of 64 and the learning rate of 0.001. The trainable parameters are all affine parameters of layer normalization layers (except for the experiments in Table 9). For updating prompts with SGD optimizer in Table 9 with entropy loss, the learning rate is set to 0.01 and the number of inserted prompts is set to 3. ",
        "bbox": [
            501,
            487,
            887,
            623
        ],
        "page_idx": 15
    },
    {
        "type": "text",
        "text": "$\\mathbf { S A R } ^ { 8 }$ (Niu et al., 2023). We follow all hyper-parameters that are set in SAR unless it does not provide. Specifically, we use SGD as the update rule, with a momentum of 0.9, batch size of 64 and the learning rate of 0.001. The entropy threshold $E _ { 0 }$ is set to $0 . 4 \\times \\ln C$ , where $C$ is the number of task classes. The trainable parameters are the affine parameters of the layer normalization layers from blocks1 to blocks8 for ViT-Base. ",
        "bbox": [
            500,
            631,
            885,
            751
        ],
        "page_idx": 15
    },
    {
        "type": "text",
        "text": "$\\mathbf { C o T T A } ^ { 9 }$ (Wang et al., 2022). We follow all hyperparameters that are set in CoTTA unless it does not provide. Specifically, we use SGD as the update rule, with a momentum of 0.9, batch size of 64 and the learning rate of 0.05. The augmentation threshold $p _ { t h }$ is set to 0.1. For images below threshold, we conduct 32 augmentations including color jitter, random affine, Gaussian blur, random horizonal flip, and Gaussian noise. The restoration probability of is set to 0.01 and the EMA factor $\\alpha$ for teacher update is set to 0.999. The trainable parameters are all the parameters in ViT-Base. ",
        "bbox": [
            500,
            758,
            885,
            835
        ],
        "page_idx": 15
    },
    {
        "type": "discarded",
        "text": "6https://github.com/matsuolab/T3A 7https://github.com/DequanWang/tent 8https://github.com/mr-eggplant/SAR 9https://github.com/qinenergy/cotta ",
        "bbox": [
            519,
            844,
            745,
            900
        ],
        "page_idx": 15
    },
    {
        "type": "discarded",
        "text": "1https://storage.googleapis.com/vit models/augreg/B 16- i21k-300ep-lr 0.001-aug medium1-wd 0.1-do 0.0-sd 0.0– imagenet2012-steps 20k-lr 0.01-res 224.npz 2https://github.com/pprp/timm 3https://github.com/hahnyuan/PTQ4ViT 4https://github.com/CMA-ES/pycma 5https://github.com/fiveai/LAME ",
        "bbox": [
            88,
            799,
            450,
            893
        ],
        "page_idx": 15
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            312,
            58,
            661,
            69
        ],
        "page_idx": 15
    },
    {
        "type": "discarded",
        "text": "",
        "bbox": [
            478,
            924,
            495,
            934
        ],
        "page_idx": 15
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            88,
            85,
            475,
            160
        ],
        "page_idx": 16
    },
    {
        "type": "text",
        "text": "C. More Ablation Studies ",
        "text_level": 1,
        "bbox": [
            89,
            179,
            302,
            196
        ],
        "page_idx": 16
    },
    {
        "type": "text",
        "text": "Effects of Trade-off Parameter $\\lambda$ in Eqn. (5). In the main paper, we simply set the trade-off parameter $\\lambda$ in our fitness function (see Eqn. (5)) to 0.4, to balance the magnitude of two terms. Here, we further investigate the sensitivity of $\\lambda$ selected from $\\{ 0 . 1 , 0 . 2 , 0 . 3 , 0 . 4 , 0 . 5 , 0 . 6 , 0 . 7 , 0 . 8 , 0 . 9 , 1 . 0 \\}$ From Table 13, FOA maintains comparable accuracy across different values of $\\lambda$ as the accuracy variation is not very large, highlighting its insensitivity to changes in $\\lambda$ . Despite this insensitivity, FOA achieves better overall performance with $\\lambda$ selected from $\\{ 0 . 3 , 0 . 4 , 0 . 5 \\}$ in terms of both accuracy and ECE. The observed excellent performance in this range can be attributed to the balanced magnitude of the two terms in Eqn. (5). ",
        "bbox": [
            89,
            205,
            473,
            401
        ],
        "page_idx": 16
    },
    {
        "type": "text",
        "text": "Effects of Exponential Moving Average (EMA) in Eqn. (9). In Table 14, we investigate the effectiveness of EMA in Eqn. (9), which is designed to estimate the center of activation features of OOD testing samples accurately. The results show that without Eqn. (9), Activation $( A c t . )$ Shifting suffers from notable performance degradation in both accuracy and ECE, particularly when using small batch sizes (e.g., $B S < 8$ ) where batch statistics are less accurate. In contrast, incorporating EMA ensures stable performance even with a batch size of 1, suggesting its effectiveness. ",
        "bbox": [
            88,
            410,
            473,
            560
        ],
        "page_idx": 16
    },
    {
        "type": "text",
        "text": "Effects of Exponential Moving Average (EMA) in Calculating Eqn. (5). In the main paper, we consistently use the batch statistics $\\mu _ { i } ( \\mathcal { X } _ { t } )$ and $\\pmb { \\sigma } _ { i } ( \\mathcal { X } _ { t } )$ to calculate Activation Discrepancy fitness. In Table 15, we further investigate the effects of using EMA to estimate the overall test set statistics for the fitness function calculation. The results indicate a degradation in performance when the balance factor $\\beta$ is notably small. This decline is attributed to a biased objective, which encourages batch statistics to compensate for alignment errors in historical overall statistics rather than converging towards the source in-distribution statistics. In contrast, using $\\mu _ { i } ( \\mathcal { X } _ { t } )$ and $\\pmb { \\sigma } _ { i } ( \\mathcal { X } _ { t } )$ (i.e., $\\beta = 1 . 0$ ) for Eqn. (5) achieves remarkable performance on both ImageNet-C and ImageNet-R, without requiring additional hyperparameter. ",
        "bbox": [
            89,
            568,
            473,
            779
        ],
        "page_idx": 16
    },
    {
        "type": "text",
        "text": "Comparison with MEMO (Zhang et al., 2022) under Different Number of Test Samples. To verify the effectiveness of FOA when only limited test samples are available for adaptation, we record the model’s accuracy on the entire test set after the online adaption on $N$ test samples. From Figure 4, our FOA outperforms MEMO and NoAdapt at the beginning of the test data stream, i.e., less than 200 samples, showing that FOA does not rely on a long test data stream. The good performance mainly benefits from our Activation Shifting scheme, which boosts the performance a lot in cases of the CMA-based prompt adaptation is inadequate, e.g., at the beginning of adaptation. Here, FOA with a small batch size (BS) of 4 adapts faster, as a smaller batch size leads to more learning steps. ",
        "bbox": [
            88,
            786,
            473,
            892
        ],
        "page_idx": 16
    },
    {
        "type": "image",
        "img_path": "images/1af27f6ca711f60ce715d2992b5f2e11d305f68ca1b1bdd797a9c016b6d14464.jpg",
        "image_caption": [
            "Figure 4. Online accuracy comparison with MEMO (Zhang et al., 2022) on ViT and ImageNet-C (Gaussian noise, severity level 5). "
        ],
        "image_footnote": [],
        "bbox": [
            547,
            88,
            823,
            255
        ],
        "page_idx": 16
    },
    {
        "type": "text",
        "text": "",
        "bbox": [
            501,
            314,
            885,
            420
        ],
        "page_idx": 16
    },
    {
        "type": "text",
        "text": "D. More Experimental Results ",
        "text_level": 1,
        "bbox": [
            501,
            439,
            754,
            455
        ],
        "page_idx": 16
    },
    {
        "type": "text",
        "text": "More Results w.r.t. ECE. In Tables 2 and 3 of the main paper, we only report the average ECE due to page limits. In this subsection, we provide detailed ECEs for both full-precision and quantized models. From Tables 16 and Table 17, our FOA consistently outperforms the state-ofthe-art methods among most corruptions and achieves much lower average ECE, e.g., $3 . 2 \\%$ vs. $7 . 0 \\%$ compared with SAR on full precision ViT-Base and $3 . 8 \\%$ vs. $2 5 . 9 \\%$ compared with T3A on 8-bit quantized ViT-Base. These results demonstrate consistent effects of our FOA on mitigating the calibration error, further highlighting our effectiveness. Here, the excellent ECEs achieved by FOA mainly originate from our activation discrepancy regularization item in Eqn. (5), which alleviates the error accumulation issue of prior gradient-based TTA methods (e.g., TENT (Wang et al., 2021) and SAR (Niu et al., 2023)) that may employ imprecise pseudo labels or entropy for test-time model updating. ",
        "bbox": [
            501,
            464,
            885,
            722
        ],
        "page_idx": 16
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            310,
            58,
            661,
            69
        ],
        "page_idx": 16
    },
    {
        "type": "discarded",
        "text": "",
        "bbox": [
            478,
            922,
            495,
            934
        ],
        "page_idx": 16
    },
    {
        "type": "table",
        "img_path": "images/0526a3d4ee387cee3909872332e35e7e80dd42ff5fd077dc49421798d60fd794.jpg",
        "table_caption": [
            "Table 13. Sensitivity analyses regarding the trade-off parameter $\\lambda$ (see Eqn. (5)) in our FOA. We report results on ImageNet-C (Gaussian noise, severity level 5) using ViT-Base with batch size 64. "
        ],
        "table_footnote": [],
        "table_body": "<table><tr><td></td><td>入= 0.1</td><td>入=0.2</td><td></td><td></td><td></td><td></td><td>入=0.3 λ=0.4 入=0.5 λ=0.6 入=0.7 λ=0.8</td><td></td><td>入=0.9</td><td>入= 1.0</td></tr><tr><td>Acc. (%,↑)</td><td>61.1</td><td>61.8</td><td>61.7</td><td>61.5</td><td>61.3</td><td>61.4</td><td>61.5</td><td>61.3</td><td>61.2</td><td>61.2</td></tr><tr><td>ECE(%,↓)</td><td>5.9</td><td>3.2</td><td>2.6</td><td>2.5</td><td>2.6</td><td>2.9</td><td>3.3</td><td>3.8</td><td>4.0</td><td>4.4</td></tr></table>",
        "bbox": [
            129,
            137,
            848,
            185
        ],
        "page_idx": 17
    },
    {
        "type": "table",
        "img_path": "images/1b265258c4d2d6475b525fbf74e085fdc86214d302c861c922eeb70db10d44bf.jpg",
        "table_caption": [
            "Table 14. Effects of exponential moving average (EMA) (Eqn. (9)) in our Back-to-Source Activation (Act.) Shifting scheme. For Act. Shifting w/o EMA, we directly utilize the batch statistics $\\mu _ { N } ( \\mathcal { X } _ { t } )$ to calculate the shifting direction $\\mathbf { d } _ { t }$ in Eqn. (8). We report the average results over 15 corruptions on ImageNet-C (severity level 5) with ViT-Base. "
        ],
        "table_footnote": [],
        "table_body": "<table><tr><td colspan=\"2\"></td><td rowspan=\"2\">NoAdapt</td><td colspan=\"7\">BS=8 BS=16 BS=32</td></tr><tr><td>Act.Shifting w/o EMA</td><td></td><td>BS=1 0.1</td><td>BS=2 56.9</td><td>BS=4 58.4</td><td>58.8</td><td>59.0</td><td>59.1</td><td>BS= 64 59.1</td></tr><tr><td rowspan=\"2\">Acc. (%, ↑)</td><td>Act. Shifting with EMA (Ours)</td><td rowspan=\"2\">55.5</td><td>59.0</td><td>59.1</td><td>59.1</td><td>59.1</td><td>59.1</td><td>59.1</td><td>59.2</td></tr><tr><td>Act. Shifting w/o EMA</td><td>0.0</td><td>52.4</td><td>37.5</td><td>24.5</td><td>18.0</td><td>15.1</td><td>13.8</td></tr><tr><td>ECE(%,↓)</td><td>Act. Shifting with EMA (Ours)</td><td>10.5</td><td>12.7</td><td>12.7</td><td>12.7</td><td>12.7</td><td>12.7</td><td>12.7</td><td>12.7</td></tr></table>",
        "bbox": [
            130,
            271,
            848,
            343
        ],
        "page_idx": 17
    },
    {
        "type": "table",
        "img_path": "images/9aeb6cc0109c51b4f927d3540321d18f1b0296dfe9130931ead0e86c35725599.jpg",
        "table_caption": [
            "Table 15. Effects of exponential moving average (EMA) in calculating Activation Discrepancy fitness in Eqn. (5). We replace $\\mu _ { i } ( \\mathcal { X } _ { t } )$ with $\\beta * \\pmb { \\mu } _ { i } ( \\pmb { \\chi } _ { t } ) + ( 1 - \\beta ) * \\pmb { \\mu } _ { i } ( t - 1 )$ and replace $\\pmb { \\sigma } _ { i } ( \\pmb { \\mathcal { X } } _ { t } )$ in a similar manner. $\\beta = 1 . 0$ equals to without using EMA. We report results on ImageNet-C (Gaussian, severity level 5) and ImageNet-R with ViT-Base. "
        ],
        "table_footnote": [],
        "table_body": "<table><tr><td></td><td></td><td>|β = 0.1</td><td>β=0.2</td><td>β=0.3</td><td>β=0.4</td><td>β=0.5</td><td>β=0.6</td><td>β=0.7</td><td>β=0.8</td><td>β=0.9</td><td>β= 1.0</td></tr><tr><td rowspan=\"2\">ImageNet-C</td><td>Acc.(%,↑）</td><td>61.0</td><td>61.4</td><td>61.5</td><td>61.4</td><td>61.5</td><td>61.7</td><td>61.7</td><td>61.2</td><td>61.9</td><td>61.5</td></tr><tr><td>ECE(%,↓）</td><td>9.5</td><td>7.2</td><td>4.7</td><td>4.4</td><td>3.8</td><td>3.1</td><td>3.1</td><td>3.0</td><td>3.6</td><td>2.5</td></tr><tr><td rowspan=\"2\">ImageNet-R</td><td>Acc.(%,↑)</td><td>47.8</td><td>56.8</td><td>63.1</td><td>63.4</td><td>62.6</td><td>63.0</td><td>63.2</td><td>64.2</td><td>63.0</td><td>63.8</td></tr><tr><td>ECE(%,↓)</td><td>19.2</td><td>8.4</td><td>2.8</td><td>2.8</td><td>3.0</td><td>2.8</td><td>2.8</td><td>2.4</td><td>3.1</td><td>2.7</td></tr></table>",
        "bbox": [
            130,
            428,
            848,
            503
        ],
        "page_idx": 17
    },
    {
        "type": "table",
        "img_path": "images/6425b782a5a2cb08748a289b8ec043b208b9c8235739c758e4072580d60b41f8.jpg",
        "table_caption": [
            "Table 16. Comparisons with state-of-the-art methods on ImageNet-C (severity level 5) with ViT-Base regarding ECE $( \\% , \\downarrow )$ . BP is short for backward propagation and the bold number indicates the best result. "
        ],
        "table_footnote": [],
        "table_body": "<table><tr><td></td><td></td><td colspan=\"3\">Noise</td><td colspan=\"4\">Blur</td><td colspan=\"3\">Weather</td><td colspan=\"6\"></td></tr><tr><td>Method</td><td>BP</td><td>Gauss.</td><td>Shot</td><td>Impul.</td><td>Defoc.</td><td>Glass Motion Zoom</td><td></td><td></td><td>Snow</td><td></td><td>Frost Fog</td><td>Brit.</td><td>Contr.</td><td>Elas.</td><td>Pix.</td><td>JPEG</td><td>Avg.</td></tr><tr><td>NoAdapt</td><td>×</td><td>7.5</td><td>4.6</td><td>6.6</td><td>6.5</td><td>6.2</td><td>2.6</td><td>5.0</td><td>4.7</td><td>19.7</td><td>49.2</td><td>8.6</td><td>19.3</td><td>6.0</td><td>5.0</td><td>6.2</td><td>10.5</td></tr><tr><td>LAME</td><td>×</td><td>6.5</td><td>3.6</td><td>5.6</td><td>5.1</td><td>9.4</td><td>2.2</td><td>6.2</td><td>5.6</td><td>18.1</td><td>46.3</td><td>7.7</td><td>29.0</td><td>10.6</td><td>3.9</td><td>5.0</td><td>11.0</td></tr><tr><td>T3A</td><td>×</td><td>29.6</td><td>30.0</td><td>29.6</td><td>31.1</td><td>42.0</td><td>32.1</td><td>37.1</td><td>25.7</td><td>26.2</td><td>14.7</td><td>16.6</td><td>6.1</td><td>35.0</td><td>24.4</td><td>22.5</td><td>26.8</td></tr><tr><td>TENT</td><td>v</td><td>13.7</td><td>13.0</td><td>12.9</td><td>14.7</td><td>15.9</td><td>12.7</td><td>15.3</td><td>24.9</td><td>12.1</td><td>93.5</td><td>6.0</td><td>10.7</td><td>14.4</td><td>8.7</td><td>9.3</td><td>18.5</td></tr><tr><td>CoTTA</td><td>v</td><td>4.2</td><td>2.9</td><td>4.4</td><td>7.2</td><td>12.8</td><td>7.1</td><td>11.6</td><td>4.1</td><td>0.9</td><td>5.1</td><td>3.2</td><td>15.9</td><td>8.1</td><td>5.1</td><td>5.4</td><td>6.5</td></tr><tr><td>SAR</td><td>v</td><td>7.9</td><td>7.4</td><td>7.3</td><td>9.0</td><td>9.5</td><td>7.7</td><td>9.7</td><td>6.1</td><td>6.0</td><td>9.2</td><td>2.3</td><td>7.5</td><td>7.0</td><td>4.3</td><td>4.4</td><td>7.0</td></tr><tr><td>FOA (ours)</td><td>X</td><td>2.5</td><td>2.4</td><td>2.5</td><td>3.4</td><td>3.3</td><td>3.0</td><td>4.0</td><td>3.2</td><td>3.3</td><td>4.8</td><td>3.0</td><td>3.4</td><td>3.2</td><td>3.0</td><td>2.8</td><td>3.2</td></tr></table>",
        "bbox": [
            91,
            575,
            885,
            702
        ],
        "page_idx": 17
    },
    {
        "type": "table",
        "img_path": "images/fc5bc710d9bf2aa73de397e5bc5c412927b446d9f657a56dcba73f7a04b8bf25.jpg",
        "table_caption": [
            "Table 17. Effectiveness of our FOA on Quantized ViT-Base models. We report the corruption ECE $( \\% , \\downarrow )$ on ImageNet-C (severity level 5). The bold number indicates the best result. "
        ],
        "table_footnote": [],
        "table_body": "<table><tr><td></td><td></td><td colspan=\"3\">Noise</td><td colspan=\"4\">Blur</td><td colspan=\"4\">Weather</td><td colspan=\"5\">Digital</td></tr><tr><td></td><td>Model Method</td><td>Gauss.</td><td>Shot</td><td>Impul.1</td><td>Defoc.</td><td>Glass Motion</td><td></td><td>Zoom</td><td>Snow</td><td>Frost Fog</td><td></td><td>Brit.</td><td>Contr.</td><td></td><td>Elas.Pix.</td><td>JPEG</td><td>Avg.</td></tr><tr><td rowspan=\"2\">8-bit</td><td>NoAdapt</td><td>8.3</td><td>5.7</td><td>7.5</td><td>7.9</td><td>4.9</td><td>3.0</td><td>4.4</td><td>5.5</td><td>20.7</td><td>50.0</td><td>10.4</td><td>14.1</td><td>5.2</td><td>6.2</td><td>8.3</td><td>10.8</td></tr><tr><td>T3A</td><td>30.0</td><td>26.0</td><td>25.7</td><td>28.7</td><td>41.9</td><td>31.2</td><td>40.1</td><td>27.2</td><td>21.6</td><td>9.6</td><td>15.8</td><td>5.7</td><td>40.7</td><td>23.1</td><td>21.0</td><td>25.9</td></tr><tr><td rowspan=\"3\">6-bit</td><td>FOA (ours)</td><td>2.8</td><td>3.4</td><td>2.9</td><td>3.5</td><td>3.5</td><td>3.1</td><td>4.3</td><td>3.6</td><td>3.9</td><td>5.6</td><td>3.9</td><td>5.0</td><td>3.6</td><td>3.9</td><td>3.1</td><td>3.8</td></tr><tr><td>NoAdapt</td><td>10.1</td><td>7.0</td><td>10.5</td><td>5.8</td><td>4.2</td><td>4.2</td><td>4.5</td><td>2.8</td><td>18.0</td><td>32.5</td><td>12.4</td><td>17.3</td><td>4.2</td><td>6.6</td><td>7.8</td><td>9.9</td></tr><tr><td>T3A</td><td></td><td>27.3</td><td>26.2</td><td>43.2</td><td>50.4</td><td>35.6</td><td>49.3</td><td>33.9</td><td>22.8</td><td>14.6</td><td>16.9</td><td>7.7</td><td>44.2</td><td>26.6</td><td>22.2</td><td>30.1</td></tr><tr><td></td><td>FOA (ours)</td><td>31.3 5.6</td><td>4.9</td><td>6.7</td><td>3.1</td><td>2.4</td><td>5.0</td><td>3.5</td><td>6.6</td><td>7.1</td><td>7.0</td><td>6.0</td><td>7.7</td><td>3.3</td><td>5.8</td><td>7.7</td><td>5.5</td></tr></table>",
        "bbox": [
            91,
            773,
            885,
            885
        ],
        "page_idx": 17
    },
    {
        "type": "discarded",
        "text": "Test-Time Model Adaptation with Only Forward Passes ",
        "bbox": [
            310,
            58,
            661,
            70
        ],
        "page_idx": 17
    },
    {
        "type": "discarded",
        "text": "",
        "bbox": [
            478,
            922,
            495,
            934
        ],
        "page_idx": 17
    }
]